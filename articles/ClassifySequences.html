<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="DECIPHER">
<title>Classify Sequences • DECIPHER</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Classify Sequences">
<meta property="og:description" content="DECIPHER">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">DECIPHER</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.29.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/ArtOfAlignmentInR.html">The Art of Multiple Sequence Alignment in R</a>
    <a class="dropdown-item" href="../articles/ClassifySequences.html">Classify Sequences</a>
    <a class="dropdown-item" href="../articles/ClusteringSequences.html">Upsize your clustering with Clusterize</a>
    <a class="dropdown-item" href="../articles/DECIPHERing.html">Getting Started DECIPHERing</a>
    <a class="dropdown-item" href="../articles/DesignMicroarray.html">Design Microarray Probes</a>
    <a class="dropdown-item" href="../articles/DesignPrimers.html">Design Group-Specific Primers</a>
    <a class="dropdown-item" href="../articles/DesignProbes.html">Design Group-Specific FISH Probes</a>
    <a class="dropdown-item" href="../articles/DesignSignatures.html">Design Primers That Yield Group-Specific Signatures</a>
    <a class="dropdown-item" href="../articles/FindChimeras.html">Finding Chimeric Sequences</a>
    <a class="dropdown-item" href="../articles/FindingGenes.html">The Magic of Gene Finding</a>
    <a class="dropdown-item" href="../articles/FindingNonCodingRNAs.html">The Double Life of RNA: Uncovering Non-Coding RNAs</a>
    <a class="dropdown-item" href="../articles/GrowingTrees.html">Growing phylogenetic trees with TreeLine</a>
    <a class="dropdown-item" href="../articles/RepeatRepeat.html">Repeat, Repeat!</a>
    <a class="dropdown-item" href="../articles/normal.html">normal</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Classify Sequences</h1>
                        <h4 data-toc-skip class="author">Erik S.
Wright</h4>
            
            <h4 data-toc-skip class="date">2023-08-24</h4>
      
      
      <div class="d-none name"><code>ClassifySequences.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">0.3</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This document describes how to perform taxonomic classification of
amino acid or nucleotide sequences with the <strong>DECIPHER</strong>
package using the <em>IDTAXA</em> algorithm. By definition, the taxonomy
can be any scheme of classification: organismal, functional, or
operational. The <em>IDTAXA</em> algorithm is split into two phases: a
“training” phase where the classifier learns attributes of the training
set, and a “testing” phase where sequences with unknown taxonomic
assignments are classified. The objective of sequence classification is
to accurately assign a taxonomic label to as many sequences as possible,
while refraining from labeling sequences belonging to taxonomic groups
that are not represented in the training data. As a case study, the
tutorial focuses on classifying a set of 16S ribosomal RNA (rRNA) gene
sequences using a training set of 16S rRNA sequences from organisms
belonging to known taxonomic groups. Despite the focus on the 16S rRNA
gene, the <em>IDTAXA</em> process is the same for any set of sequences
where there exist a training set with known taxonomic assignments and a
testing set with unknown taxonomic assignments.</p>
</div>
<div class="section level2">
<h2 id="getting-started">Getting Started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<div class="section level3">
<h3 id="startup">Startup<a class="anchor" aria-label="anchor" href="#startup"></a>
</h3>
<p>To get started we need to load the <strong>DECIPHER</strong> package,
which automatically loads a few other required packages.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">DECIPHER</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: Biostrings</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: BiocGenerics</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'BiocGenerics'</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     IQR, mad, sd, var, xtabs</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     anyDuplicated, aperm, append, as.data.frame, basename, cbind,</span></span>
<span><span class="co">##     colnames, dirname, do.call, duplicated, eval, evalq, Filter, Find,</span></span>
<span><span class="co">##     get, grep, grepl, intersect, is.unsorted, lapply, Map, mapply,</span></span>
<span><span class="co">##     match, mget, order, paste, pmax, pmax.int, pmin, pmin.int,</span></span>
<span><span class="co">##     Position, rank, rbind, Reduce, rownames, sapply, setdiff, sort,</span></span>
<span><span class="co">##     table, tapply, union, unique, unsplit, which.max, which.min</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: S4Vectors</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: stats4</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'S4Vectors'</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:utils':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     findMatches</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     expand.grid, I, unname</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: IRanges</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: XVector</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: GenomeInfoDb</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'Biostrings'</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     strsplit</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: RSQLite</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: parallel</span></span></code></pre>
<p>The classification process is split into two parts: training carried
out by <code>LearnTaxa</code> and testing with <code>IdTaxa</code>. Help
for either function can be accessed through:</p>
<pre><code>&gt; ? IdTaxa</code></pre>
<p>Once <strong>DECIPHER</strong> is installed, the code in this
tutorial can be obtained via:</p>
<pre><code>&gt; browseVignettes("DECIPHER")</code></pre>
</div>
</div>
<div class="section level2">
<h2 id="training-the-classifier">Training the Classifier<a class="anchor" aria-label="anchor" href="#training-the-classifier"></a>
</h2>
<p>The training process only needs to occur once per training set, and
results in an object that can be reused for testing as many sequences as
desired. If you already have the output of training the classifier (an
object of class <code>Taxa</code> and subclass <code>Train</code>), then
you can skip to subsection @ref(viewing) () below. Otherwise follow
along with this section to learn how to train the classifier.</p>
<p>The training process begins with a set of sequence representatives
assigned to a taxonomic hierarchy, called a “training set”. Typically
taxonomic assignments are obtained from an authoritative source, but
they can also be automatically created (e.g., with
<code>TreeLine</code>). Here we describe the general training process,
where the classifier iteratively learns about the reference
taxonomy.</p>
<p>Note that the training sequences should ideally span the full-length
of the gene or target region. The test (query) sequences can be partial
length, but the training sequences are expected to overlap the same
region as the test sequences. Having excess training sequence beyond the
region of the test sequence should not negatively effect performance
unless it is very large amount of excess sequence. Also, the training
sequences should all have complete taxonomy. That is, every training
sequence should be classified to its terminal rank and not have an
incomplete classification.</p>
<div class="section level3">
<h3 id="importing-the-training-set">Importing the training set<a class="anchor" aria-label="anchor" href="#importing-the-training-set"></a>
</h3>
<p>The first step is to set filepaths to the sequences (in FASTA format)
and the “taxid” file containing information about taxonomic ranks. The
“taxid” file is optional, but is often provided (along with training
sequences) in a standard 5-column, asterisks (“*“) delimited, text
format used by many classifiers. To create your own”taxid” file, see
@ref(taxid) () below. Be sure to change the path names to those on your
system by replacing all of the text inside quotes labeled “<span class="math inline">\(&lt;&lt;\)</span>path to …<span class="math inline">\(&gt;&gt;\)</span>” with the actual path on your
system.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># specify the path to your file of training sequences:</span></span>
<span><span class="va">seqs_path</span> <span class="op">&lt;-</span> <span class="st">"&lt;&lt;path to training FASTA file&gt;&gt;"</span></span>
<span><span class="co"># read the sequences into memory</span></span>
<span><span class="va">seqs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Biostrings/man/XStringSet-io.html" class="external-link">readDNAStringSet</a></span><span class="op">(</span><span class="va">seqs_path</span><span class="op">)</span></span>
<span><span class="co"># Alternatively use readAAStringSet or readRNAStringSet</span></span>
<span></span>
<span><span class="co"># (optionally) specify a path to the taxid file:</span></span>
<span><span class="va">rank_path</span> <span class="op">&lt;-</span> <span class="st">"&lt;&lt;path to taxid text file&gt;&gt;"</span></span>
<span><span class="va">taxid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="va">rank_path</span>,</span>
<span>    header<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>    col.names<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Index'</span>, <span class="st">'Name'</span>, <span class="st">'Parent'</span>, <span class="st">'Level'</span>, <span class="st">'Rank'</span><span class="op">)</span>,</span>
<span>    sep<span class="op">=</span><span class="st">"*"</span>, <span class="co"># asterisks delimited</span></span>
<span>    quote<span class="op">=</span><span class="st">""</span>, <span class="co"># preserve quotes</span></span>
<span>    stringsAsFactors<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co"># OR, if no taxid text file exists, use:</span></span>
<span><span class="co">#taxid &lt;- NULL</span></span></code></pre></div>
<p>The training sequences cannot contain gap (“-” or “.”) characters,
which can easily be removed with the <code>RemoveGaps</code>
function:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># if they exist, remove any gaps in the sequences:</span></span>
<span><span class="va">seqs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RemoveGaps.html">RemoveGaps</a></span><span class="op">(</span><span class="va">seqs</span><span class="op">)</span></span></code></pre></div>
<p>Note that the training sequences must all be in the same orientation.
If this is not the case, it is possible to reorient the sequences with
<code>OrientNucleotides</code>:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ensure that all sequences are in the same orientation:</span></span>
<span><span class="va">seqs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/OrientNucleotides.html">OrientNucleotides</a></span><span class="op">(</span><span class="va">seqs</span><span class="op">)</span></span></code></pre></div>
<p>Here, we make the assumption that each sequence is labeled in the
original (FASTA) file by its taxonomy starting with “Root;”. For
example, a sequence might be labeled “AY193173 Root; Bacteria; SR1; ”,
in which case we can extract all of the text starting from “Root;” to
obtain the sequence’s “group”. In this context, groups are defined as
the set of all possible taxonomic labels that are present in the
training set.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># obtain the taxonomic assignments</span></span>
<span><span class="va">groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">seqs</span><span class="op">)</span> <span class="co"># sequence names</span></span>
<span><span class="co"># assume the taxonomy begins with 'Root;'</span></span>
<span><span class="va">groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"(.*)(Root;)"</span>, <span class="st">"\\2"</span>, <span class="va">groups</span><span class="op">)</span> <span class="co"># extract the group label</span></span>
<span><span class="va">groupCounts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">groups</span><span class="op">)</span></span>
<span><span class="va">u_groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">groupCounts</span><span class="op">)</span> <span class="co"># unique groups</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">u_groups</span><span class="op">)</span> <span class="co"># number of groups</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="pruning-the-training-set">Pruning the training set<a class="anchor" aria-label="anchor" href="#pruning-the-training-set"></a>
</h3>
<p>The next step is to count the number of representatives per group
and, <em>optionally</em>, select only a subset of sequences if the group
is deemed too large. Typically there is a diminishing return in accuracy
for having more-and-more representative sequences in a group. Limiting
groups size may be advantageous if some groups contain an inordinately
large number of sequences because it will speed up the classification
process. Also, larger groups oftentimes accumulate errors (that is,
sequences which do not belong), and constraining the group size can help
to make the classification process more robust to rare errors that may
exist in the training data. In the code below, maxGroupSize controls the
maximum size of any group, and can be set to <code>Inf</code> (infinity)
to allow for an unlimited number of sequences per group.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">maxGroupSize</span> <span class="op">&lt;-</span> <span class="fl">10</span> <span class="co"># max sequences per label (&gt;= 1)</span></span>
<span></span>
<span><span class="va">remove</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">seqs</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">groupCounts</span> <span class="op">&gt;</span> <span class="va">maxGroupSize</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">groups</span><span class="op">==</span><span class="va">u_groups</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">keep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">index</span><span class="op">)</span>,</span>
<span>        <span class="va">maxGroupSize</span><span class="op">)</span></span>
<span>    <span class="va">remove</span><span class="op">[</span><span class="va">index</span><span class="op">[</span><span class="op">-</span><span class="va">keep</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">remove</span><span class="op">)</span> <span class="co"># number of sequences eliminated</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="iteratively-training-the-classifier">Iteratively training the classifier<a class="anchor" aria-label="anchor" href="#iteratively-training-the-classifier"></a>
</h3>
<p>Now we must train the classifier on the training set. One unique
feature of the <em>IDTAXA</em> algorithm is that during the learning
process it will identify any training sequences whose assigned
classifications completely (with very high confidence) disagree with
their predicted classification. These are almost always sequences that
are mislabeled in the training data, and they can make the
classification process slower and less accurate because they introduce
error in the training data. We have the option of automatically removing
these putative “problem sequences” by iteratively repeating the training
process. However, we may also want to be careful not to remove sequences
that are the last remaining representatives of an entire group in the
training data, which can happen if the entire group appears to be
misplaced in the taxonomic tree. These two training options are
controlled by the maxIterations and allowGroupRemoval variables (below).
Setting maxIterations to <code>1</code> will simply train the classifier
without removing any problem sequences, whereas values greater than
<code>1</code> will iteratively remove problem sequences.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>maxIterations <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="co"># must be &gt;= 1</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>allowGroupRemoval <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>probSeqsPrev <span class="ot">&lt;-</span> <span class="fu">integer</span>() <span class="co"># suspected problem sequences from prior iteration</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_len</span>(maxIterations)) {</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Training iteration: "</span>, i, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">sep=</span><span class="st">""</span>)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># train the classifier</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    trainingSet <span class="ot">&lt;-</span> <span class="fu">LearnTaxa</span>(seqs[<span class="sc">!</span>remove],</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">names</span>(seqs)[<span class="sc">!</span>remove],</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>        taxid)</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># look for problem sequences</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>    probSeqs <span class="ot">&lt;-</span> trainingSet<span class="sc">$</span>problemSequences<span class="sc">$</span>Index</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(probSeqs)<span class="sc">==</span><span class="dv">0</span>) {</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="st">"No problem sequences remaining.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">length</span>(probSeqs)<span class="sc">==</span><span class="fu">length</span>(probSeqsPrev) <span class="sc">&amp;&amp;</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>        <span class="fu">all</span>(probSeqsPrev<span class="sc">==</span>probSeqs)) {</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="st">"Iterations converged.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (i<span class="sc">==</span>maxIterations)</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>    probSeqsPrev <span class="ot">&lt;-</span> probSeqs</span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># remove any problem sequences</span></span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>    index <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="sc">!</span>remove)[probSeqs]</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>    remove[index] <span class="ot">&lt;-</span> <span class="cn">TRUE</span> <span class="co"># remove all problem sequences</span></span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span>allowGroupRemoval) {</span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># replace any removed groups</span></span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>        missing <span class="ot">&lt;-</span> <span class="sc">!</span>(u_groups </span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>        missing <span class="ot">&lt;-</span> u_groups[missing]</span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">length</span>(missing) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>            index <span class="ot">&lt;-</span> index[groups[index] </span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>            remove[index] <span class="ot">&lt;-</span> <span class="cn">FALSE</span> <span class="co"># don't remove</span></span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a>    <span class="er">}</span></span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a><span class="er">}</span></span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(remove) <span class="co"># total number of sequences eliminated</span></span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(probSeqs) <span class="co"># number of remaining problem sequences</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="viewing-the-training-data">Viewing the training data<a class="anchor" aria-label="anchor" href="#viewing-the-training-data"></a>
</h3>
<p>The training process results in a training object
(<code>trainingSet</code>) of class <code>Taxa</code> and subclass
<code>Train</code> that contains all of the information required for
classification. If you want to use the pre-trained classifier for 16S
rRNA sequences, then it can be loaded with the <code>data</code>
function. However, <strong>if you just trained the classifier using your
own training data then you should skip these next two lines of
code</strong>.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"TrainingSet_16S"</span><span class="op">)</span></span>
<span><span class="va">trainingSet</span> <span class="op">&lt;-</span> <span class="va">TrainingSet_16S</span></span></code></pre></div>
<p>We can view summary properties of the training set
(<code>trainingSet</code>) by printing it:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trainingSet</span></span></code></pre></div>
<pre><code><span><span class="co">##   A training set of class 'Taxa'</span></span>
<span><span class="co">##    * K-mer size: 8</span></span>
<span><span class="co">##    * Number of rank levels: 10</span></span>
<span><span class="co">##    * Total number of sequences: 2472</span></span>
<span><span class="co">##    * Number of groups: 2472</span></span>
<span><span class="co">##    * Number of problem groups: 5</span></span>
<span><span class="co">##    * Number of problem sequences: 8</span></span></code></pre>
<p>And, as shown in Figure @ref(f1), we can plot the training set
(<code>trainingSet</code>) to view a variety of information:</p>
<ol style="list-style-type: decimal">
<li>The first panel contains the taxonomic tree with the “Root” at the
very top. This training set contains different numbers of ranks for each
group, which is why the leaves of the tree end at different heights.
Edges of the tree that are colored show putative “problem groups” that
persist after the iterative removal of “problem sequences” (see above).
These colored edges are problematic in that the classifier cannot
descend below this edge on the tree during the initial “tree descent”
phase of the algorithm. This slows down the classification process for
sequences belonging to a group below this edge, but does not affect the
classifier’s accuracy.</li>
<li>The second panel of Fig. @ref(f1) shows the number of unique groups
at each taxonomic rank, ordered from highest to lowest taxonomic rank in
the dataset. We can see that there are about 2.5 thousand genera, where
<em>genus</em> is the lowest rank in this training set.</li>
<li>The bottom left panel contains a histogram of the number of
sequences per group. The maximum group size is in accordance with the
maxGroupSize set above. Here, the pre-trained classified has only a
single sequence per group so that it will take up minimal space.
Typically classifiers will have a wide distribution of the number of
sequences per group.</li>
<li>The bottom right panel displays the <em>inverse document
frequency</em> (IDF) weights associated with each k-mer. We can see that
there are many rare k-mers that have high weights (i.e., high
information content), and a few common k-mers that have very low
weights. This highly-skewed distribution of information content among
k-mers is typical among sequence data.</li>
</ol>
</div>
</div>
<div class="section level2">
<h2 id="classifying-sequences">Classifying Sequences<a class="anchor" aria-label="anchor" href="#classifying-sequences"></a>
</h2>
<p>Now that we have trained the classifier, the next step is to use it
to assign taxonomic classifications to new sequences. This is
accomplished with the <code>IdTaxa</code> function, which takes in
“test” (new) sequences along with the training set
(<code>trainingSet</code>) object that was returned by
<code>LearnTaxa</code>. For the purposes of this tutorial, we are going
to use some 16S rRNA gene sequences collected from organisms present in
tap water. Feel free to follow along with your own sequences, or load
the FASTA file included with the tutorial.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fas</span> <span class="op">&lt;-</span> <span class="st">"&lt;&lt;path to FASTA file&gt;&gt;"</span></span>
<span><span class="co"># OR use the example 16S sequences:</span></span>
<span><span class="va">fas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,</span>
<span>    <span class="st">"Bacteria_175seqs.fas"</span>,</span>
<span>    package<span class="op">=</span><span class="st">"DECIPHER"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># read the sequences into memory</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Biostrings/man/XStringSet-io.html" class="external-link">readDNAStringSet</a></span><span class="op">(</span><span class="va">fas</span><span class="op">)</span></span>
<span><span class="co"># Alternatively use readAAStringSet or readRNAStringSet</span></span></code></pre></div>
<p>As in training (above), the test sequences cannot contain gap (“-” or
“.”) characters, which can easily be removed with the
<code>RemoveGaps</code> function:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># if they exist, remove any gaps in the sequences:</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RemoveGaps.html">RemoveGaps</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span></span>
<span><span class="va">test</span></span></code></pre></div>
<pre><code><span><span class="co">## DNAStringSet object of length 175:</span></span>
<span><span class="co">##       width seq                                             names               </span></span>
<span><span class="co">##   [1]  1235 <span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">GG</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">GG</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">GGG</span><span style="color: #000000; background-color: #FFD7AF;">T</span>...<span style="color: #000000; background-color: #FFD7AF;">TT</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">TT</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">GG</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #FFD7AF;">TT</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFFF;">GG</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFD7AF;">T</span> uncultured bacter...</span></span>
<span><span class="co">##   [2]  1351 <span style="color: #000000; background-color: #FFD7AF;">TT</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">GG</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">GG</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">GGG</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">AA</span>...<span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">TTT</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">CCC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #AFFFFF;">G</span> uncultured bacter...</span></span>
<span><span class="co">##   [3]  1326 <span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">GG</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">GG</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">GGG</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">G</span>...<span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">CCC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">A</span> uncultured bacter...</span></span>
<span><span class="co">##   [4]  1345 <span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">GGG</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span>...<span style="color: #000000; background-color: #FFD7AF;">TT</span><span style="color: #000000; background-color: #AFFFFF;">GG</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">CCC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">GG</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #AFFFFF;">G</span> uncultured bacter...</span></span>
<span><span class="co">##   [5]  1343 <span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">GGG</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">CCC</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #FFD7AF;">T</span>...<span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">CCC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #AFFFFF;">GG</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span> uncultured bacter...</span></span>
<span><span class="co">##   ...   ... ...</span></span>
<span><span class="co">## [171]  1314 <span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">GG</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">GGG</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">AAA</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFFF;">G</span>...<span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">CCC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">GGG</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">GG</span> uncultured bacter...</span></span>
<span><span class="co">## [172]  1316 <span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">GGG</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFD7AF;">TT</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFFF;">GG</span><span style="color: #000000; background-color: #FFAFAF;">AA</span>...<span style="color: #000000; background-color: #AFFFAF;">CCC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">GGG</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">TT</span><span style="color: #000000; background-color: #AFFFFF;">GG</span> uncultured bacter...</span></span>
<span><span class="co">## [173]  1308 <span style="color: #000000; background-color: #AFFFFF;">GG</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #AFFFAF;">CCCC</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">GG</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">AA</span>...<span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">TT</span><span style="color: #000000; background-color: #AFFFAF;">CCC</span><span style="color: #000000; background-color: #AFFFFF;">GGG</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #FFD7AF;">TT</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span> uncultured bacter...</span></span>
<span><span class="co">## [174]  1313 <span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">GGG</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">GG</span><span style="color: #000000; background-color: #FFD7AF;">TT</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFFF;">GG</span><span style="color: #000000; background-color: #FFD7AF;">T</span>...<span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFFF;">GGG</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">CCC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">GG</span> uncultured bacter...</span></span>
<span><span class="co">## [175]  1333 <span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFD7AF;">TTT</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">GGGGG</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFD7AF;">TT</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">GG</span><span style="color: #000000; background-color: #AFFFAF;">C</span>...<span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">AAA</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #AFFFFF;">GG</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">CCC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #AFFFFF;">G</span> uncultured bacter...</span></span></code></pre>
<div class="section level3">
<h3 id="assigning-classifications">Assigning classifications<a class="anchor" aria-label="anchor" href="#assigning-classifications"></a>
</h3>
<p>Now, for the moment we have been waiting for: it’s time to classify
some test sequences! It’s important to have read the help file for
<code>IdTaxa</code> to acquaint yourself with the available options
before performing this step. The most important (optional) arguments are
the <code>type</code> of output, the <code>strand</code> used in
testing, the confidence <code>threshold</code> of assignments, and the
number of <code>processors</code> to use. Here, we are going to request
the <code>"extended"</code> (default) output <code>type</code> that
allows for plotting the results, but there is also a
<code>"collapsed"</code> <code>type</code> that might be easier to
export (see section @ref(export) below). Also, we know that all of the
test sequences are in the same (“+” strand) orientation as the training
sequences, so we can specify to only look at the <code>"top"</code>
strand rather than the default of <code>"both"</code> strands (i.e.,
both “+” and “-” strands). This makes the classification process over
twice as fast. We could also set processors to <code>NULL</code> to use
all available processors.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/IdTaxa.html">IdTaxa</a></span><span class="op">(</span><span class="va">test</span>,</span>
<span>    <span class="va">trainingSet</span>,</span>
<span>    type<span class="op">=</span><span class="st">"extended"</span>,</span>
<span>    strand<span class="op">=</span><span class="st">"top"</span>,</span>
<span>    threshold<span class="op">=</span><span class="fl">60</span>,</span>
<span>    processors<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## ================================================================================</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Time difference of 5.11 secs</span></span></code></pre>
<pre><code>  |===========================================================================| 100%

Time difference of 12.23 secs</code></pre>
<p>The <code>threshold</code> of 60% is recommended at the default
confidence threshold. Confidence levels are informally defined as 70%
(stringent), 60% (cautious), 50% (sensible), and 40% (lenient). Using a
<code>threshold</code> of 0% will report classifications down to all
rank levels. Note that the test sequences should generally be
fully-overlapped by the information in the training sequences. In this
way, the training sequences can be longer than the test sequences, but
the reverse situation would result in lower confidences.</p>
<p>Let’s look at the results by printing the object (ids) that was
returned:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ids</span></span></code></pre></div>
<pre><code><span><span class="co">##   A test set of class 'Taxa' with length 175</span></span>
<span><span class="co">##       confidence name                 taxon</span></span>
<span><span class="co">##   [1]        73% uncultured bacter... Root; Bacteria; Firmicutes; Bacilli; Ba...</span></span>
<span><span class="co">##   [2]        68% uncultured bacter... Root; Bacteria; Firmicutes; Bacilli; Ba...</span></span>
<span><span class="co">##   [3]        63% uncultured bacter... Root; Bacteria; Firmicutes; Bacilli; Ba...</span></span>
<span><span class="co">##   [4]        92% uncultured bacter... Root; Bacteria; Firmicutes; Bacilli; La...</span></span>
<span><span class="co">##   [5]        61% uncultured bacter... Root; Bacteria; Firmicutes; Clostridia;...</span></span>
<span><span class="co">##   ...        ... ...                  ...</span></span>
<span><span class="co">## [171]        39% uncultured bacter... Root; unclassified_Root                   </span></span>
<span><span class="co">## [172]        48% uncultured bacter... Root; unclassified_Root                   </span></span>
<span><span class="co">## [173]        31% uncultured bacter... Root; unclassified_Root                   </span></span>
<span><span class="co">## [174]        49% uncultured bacter... Root; unclassified_Root                   </span></span>
<span><span class="co">## [175]        54% uncultured bacter... Root; unclassified_Root</span></span></code></pre>
<p>Note that the data has class <code>Taxa</code> and subclass
<code>Test</code>, which is stored as an object of type list. Therefore
we can access a subset of the returned object (ids) with single square
brackets (<code>[</code>) or access the contents of individual list
elements with double square brackets (<code>[[</code>):</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ids</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span> <span class="co"># summary results for the first 5 sequences</span></span></code></pre></div>
<pre><code><span><span class="co">##   A test set of class 'Taxa' with length 5</span></span>
<span><span class="co">##     confidence name                 taxon</span></span>
<span><span class="co">## [1]        73% uncultured bacter... Root; Bacteria; Firmicutes; Bacilli; Baci...</span></span>
<span><span class="co">## [2]        68% uncultured bacter... Root; Bacteria; Firmicutes; Bacilli; Baci...</span></span>
<span><span class="co">## [3]        63% uncultured bacter... Root; Bacteria; Firmicutes; Bacilli; Baci...</span></span>
<span><span class="co">## [4]        92% uncultured bacter... Root; Bacteria; Firmicutes; Bacilli; Lact...</span></span>
<span><span class="co">## [5]        61% uncultured bacter... Root; Bacteria; Firmicutes; Clostridia; C...</span></span></code></pre>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ids</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="co"># results for the first sequence</span></span></code></pre></div>
<pre><code><span><span class="co">## $taxon</span></span>
<span><span class="co">## [1] "Root"                        "Bacteria"                   </span></span>
<span><span class="co">## [3] "Firmicutes"                  "Bacilli"                    </span></span>
<span><span class="co">## [5] "Bacillales"                  "Planococcaceae"             </span></span>
<span><span class="co">## [7] "unclassified_Planococcaceae"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $confidence</span></span>
<span><span class="co">## [1] 74.21434 74.21434 74.21434 74.21434 74.21434 73.49649 73.49649</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $rank</span></span>
<span><span class="co">## [1] "rootrank" "domain"   "phylum"   "class"    "order"    "family"   "genus"</span></span></code></pre>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ids</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">25</span><span class="op">)</span><span class="op">]</span> <span class="co"># combining different sequences</span></span></code></pre></div>
<pre><code><span><span class="co">##   A test set of class 'Taxa' with length 2</span></span>
<span><span class="co">##     confidence name                 taxon</span></span>
<span><span class="co">## [1]        49% uncultured bacter... Root; unclassified_Root                     </span></span>
<span><span class="co">## [2]        34% uncultured bacter... Root; unclassified_Root</span></span></code></pre>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">ids</span><span class="op">[</span><span class="fl">10</span><span class="op">]</span>, <span class="va">ids</span><span class="op">[</span><span class="fl">25</span><span class="op">]</span><span class="op">)</span> <span class="co"># merge different sets</span></span></code></pre></div>
<pre><code><span><span class="co">##   A test set of class 'Taxa' with length 2</span></span>
<span><span class="co">##     confidence name                 taxon</span></span>
<span><span class="co">## [1]        49% uncultured bacter... Root; unclassified_Root                     </span></span>
<span><span class="co">## [2]        34% uncultured bacter... Root; unclassified_Root</span></span></code></pre>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ids</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rootrank"</span>, <span class="st">"domain"</span>, <span class="st">"class"</span><span class="op">)</span><span class="op">]</span> <span class="co"># only look at specific rank levels</span></span></code></pre></div>
<pre><code><span><span class="co">##   A test set of class 'Taxa' with length 175</span></span>
<span><span class="co">##       confidence name                 taxon</span></span>
<span><span class="co">##   [1]        74% uncultured bacter... Root; Bacteria; Bacilli                   </span></span>
<span><span class="co">##   [2]        71% uncultured bacter... Root; Bacteria; Bacilli                   </span></span>
<span><span class="co">##   [3]        68% uncultured bacter... Root; Bacteria; Bacilli                   </span></span>
<span><span class="co">##   [4]        92% uncultured bacter... Root; Bacteria; Bacilli                   </span></span>
<span><span class="co">##   [5]        66% uncultured bacter... Root; Bacteria; Clostridia                </span></span>
<span><span class="co">##   ...        ... ...                  ...</span></span>
<span><span class="co">## [171]        39% uncultured bacter... Root; unclassified_Root                   </span></span>
<span><span class="co">## [172]        48% uncultured bacter... Root; unclassified_Root                   </span></span>
<span><span class="co">## [173]        31% uncultured bacter... Root; unclassified_Root                   </span></span>
<span><span class="co">## [174]        49% uncultured bacter... Root; unclassified_Root                   </span></span>
<span><span class="co">## [175]        54% uncultured bacter... Root; unclassified_Root</span></span></code></pre>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ids</span><span class="op">[</span>threshold<span class="op">=</span><span class="fl">70</span><span class="op">]</span> <span class="co"># threshold the results at a higher confidence</span></span></code></pre></div>
<pre><code><span><span class="co">##   A test set of class 'Taxa' with length 175</span></span>
<span><span class="co">##       confidence name                 taxon</span></span>
<span><span class="co">##   [1]        73% uncultured bacter... Root; Bacteria; Firmicutes; Bacilli; Ba...</span></span>
<span><span class="co">##   [2]        71% uncultured bacter... Root; Bacteria; Firmicutes; Bacilli; Ba...</span></span>
<span><span class="co">##   [3]        68% uncultured bacter... Root; unclassified_Root...                </span></span>
<span><span class="co">##   [4]        92% uncultured bacter... Root; Bacteria; Firmicutes; Bacilli; La...</span></span>
<span><span class="co">##   [5]        66% uncultured bacter... Root; unclassified_Root...                </span></span>
<span><span class="co">##   ...        ... ...                  ...</span></span>
<span><span class="co">## [171]        39% uncultured bacter... Root; unclassified_Root                   </span></span>
<span><span class="co">## [172]        48% uncultured bacter... Root; unclassified_Root                   </span></span>
<span><span class="co">## [173]        31% uncultured bacter... Root; unclassified_Root                   </span></span>
<span><span class="co">## [174]        49% uncultured bacter... Root; unclassified_Root                   </span></span>
<span><span class="co">## [175]        54% uncultured bacter... Root; unclassified_Root</span></span></code></pre>
<p>The output can easily be converted to a character vector with
taxonomic information assigned to each sequence:</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">assignment</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">ids</span>,</span>
<span>    <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">taxon</span>,</span>
<span>            collapse<span class="op">=</span><span class="st">";"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">assignment</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                                               uncultured bacterium; Pro_CL-05069_OTU-15. </span></span>
<span><span class="co">## "Root;Bacteria;Firmicutes;Bacilli;Bacillales;Planococcaceae;unclassified_Planococcaceae" </span></span>
<span><span class="co">##                                               uncultured bacterium; Fin_CL-100646_OTU-6. </span></span>
<span><span class="co">##           "Root;Bacteria;Firmicutes;Bacilli;Bacillales;Staphylococcaceae;Staphylococcus" </span></span>
<span><span class="co">##                                              uncultured bacterium; Mar_CL-050642_OTU-13. </span></span>
<span><span class="co">##           "Root;Bacteria;Firmicutes;Bacilli;Bacillales;Staphylococcaceae;Staphylococcus" </span></span>
<span><span class="co">##                                               uncultured bacterium; Mar_CL-100626_OTU-8. </span></span>
<span><span class="co">##      "Root;Bacteria;Firmicutes;Bacilli;Lactobacillales;Carnobacteriaceae;Dolosigranulum" </span></span>
<span><span class="co">##                                              uncultured bacterium; Fin_CL-100633_OTU-22. </span></span>
<span><span class="co">##   "Root;Bacteria;Firmicutes;Clostridia;Clostridiales;Peptococcaceae 1;Desulfosporosinus" </span></span>
<span><span class="co">##                                               uncultured bacterium; Fin_CL-050645_OTU-2. </span></span>
<span><span class="co">##                                                                 "Root;unclassified_Root"</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="plotting-the-results">Plotting the results<a class="anchor" aria-label="anchor" href="#plotting-the-results"></a>
</h3>
<p>We can also plot the results, as shown in Figure @ref(f2). This
produces a pie chart showing the relative abundance of the taxonomic
groups assigned to test sequences. It also displays the training
taxonomic tree, with edges colored where they match the taxonomic groups
shown in the pie chart. Note that we could also have only plotted the
pie chart by omitting the <code>trainingSet</code>. Also, it is possible
to specify the parameter <code>n</code> if each classification
represents a varying number of sequences, e.g., when only unique
sequences were originally classified.</p>
</div>
<div class="section level3">
<h3 id="create-and-plot-a-classification-table">Create and plot a classification table<a class="anchor" aria-label="anchor" href="#create-and-plot-a-classification-table"></a>
</h3>
<p>When analyzing multiple samples, it is often useful to create a
classification table with the number of times each taxon is observed.
Here we can choose a specific taxonomic rank to consider, or simply
select the lowest (i.e., basal) taxonomic level:</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">phylum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">ids</span>,</span>
<span>    <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">rank</span><span class="op">==</span><span class="st">"phylum"</span><span class="op">)</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span> <span class="op">!=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="st">"unknown"</span></span>
<span>        <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>            <span class="va">x</span><span class="op">$</span><span class="va">taxon</span><span class="op">[</span><span class="va">w</span><span class="op">]</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">phylum</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## phylum</span></span>
<span><span class="co">## "Actinobacteria"  "Bacteroidetes" "Proteobacteria"       Firmicutes </span></span>
<span><span class="co">##               26                8               78                5 </span></span>
<span><span class="co">##      Nitrospirae          unknown </span></span>
<span><span class="co">##                5               53</span></span></code></pre>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">taxon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">ids</span>,</span>
<span>    <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>        <span class="va">x</span><span class="op">$</span><span class="va">taxon</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">taxon</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">taxon</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  uncultured bacterium; Pro_CL-05069_OTU-15. </span></span>
<span><span class="co">##               "unclassified_Planococcaceae" </span></span>
<span><span class="co">##  uncultured bacterium; Fin_CL-100646_OTU-6. </span></span>
<span><span class="co">##                            "Staphylococcus" </span></span>
<span><span class="co">## uncultured bacterium; Mar_CL-050642_OTU-13. </span></span>
<span><span class="co">##                            "Staphylococcus" </span></span>
<span><span class="co">##  uncultured bacterium; Mar_CL-100626_OTU-8. </span></span>
<span><span class="co">##                            "Dolosigranulum" </span></span>
<span><span class="co">## uncultured bacterium; Fin_CL-100633_OTU-22. </span></span>
<span><span class="co">##                         "Desulfosporosinus" </span></span>
<span><span class="co">##  uncultured bacterium; Fin_CL-050645_OTU-2. </span></span>
<span><span class="co">##                         "unclassified_Root"</span></span></code></pre>
<p>Next, we need to know which test sequences belonged to each sample.
This must be in the form of a vector of sample names that is the same
length as the number of samples. For example, in this case the sample
names are part of the sequence names. Using this vector we can easily
generate a classification table:</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get a vector with the sample name for each sequence</span></span>
<span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">".*; (.+?)_.*"</span>, <span class="st">"\\1"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">taxaTbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">taxon</span>, <span class="va">samples</span><span class="op">)</span></span>
<span><span class="va">taxaTbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">taxaTbl</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">taxaTbl</span><span class="op">)</span><span class="op">)</span> <span class="co"># normalize by sample</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">taxaTbl</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                 samples</span></span>
<span><span class="co">## taxon              Chlminus    Chlplus        Fin        LO1        LO3</span></span>
<span><span class="co">##   Achromobacter  0.00000000 0.03846154 0.00000000 0.00000000 0.00000000</span></span>
<span><span class="co">##   Acidovorax     0.07692308 0.00000000 0.00000000 0.00000000 0.00000000</span></span>
<span><span class="co">##   Afipia         0.07692308 0.00000000 0.00000000 0.00000000 0.00000000</span></span>
<span><span class="co">##   Asinibacterium 0.00000000 0.03846154 0.00000000 0.00000000 0.00000000</span></span>
<span><span class="co">##   Blastomonas    0.00000000 0.00000000 0.00000000 0.00000000 0.00000000</span></span>
<span><span class="co">##   Brevundimonas  0.00000000 0.03846154 0.00000000 0.00000000 0.12500000</span></span>
<span><span class="co">##                 samples</span></span>
<span><span class="co">## taxon                   Mar        Pro        UWH        UWL</span></span>
<span><span class="co">##   Achromobacter  0.00000000 0.00000000 0.00000000 0.00000000</span></span>
<span><span class="co">##   Acidovorax     0.00000000 0.00000000 0.00000000 0.00000000</span></span>
<span><span class="co">##   Afipia         0.00000000 0.00000000 0.00000000 0.00000000</span></span>
<span><span class="co">##   Asinibacterium 0.00000000 0.00000000 0.00000000 0.00000000</span></span>
<span><span class="co">##   Blastomonas    0.00000000 0.00000000 0.04166667 0.00000000</span></span>
<span><span class="co">##   Brevundimonas  0.00000000 0.00000000 0.04166667 0.00000000</span></span></code></pre>
<p>We can summarize the results in a stacked <code>barplot</code>:</p>
</div>
<div class="section level3">
<h3 id="exporting-the-classifications">Exporting the classifications<a class="anchor" aria-label="anchor" href="#exporting-the-classifications"></a>
</h3>
<p>{#export}</p>
<p>We can switch between outputting in <code>extended</code> or
<code>collapsed</code> format by setting the <code>type</code> argument
in <code>IdTaxa</code>. The <code>collapsed</code> <code>type</code> of
output is simply a character vector, which cannot be plotted but is easy
to write to a text file with the <code>writeLines</code> function. In
this tutorial we requested the <code>extended</code> <code>type</code>
of output, which is stored in a list structure that must be converted
into a character vector before we can write it to a text file. Here we
may choose what we want the text output to look like, by pasting
together the result for each sequence using delimiters. For example:</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">ids</span>,</span>
<span>    <span class="kw">function</span> <span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">id</span><span class="op">$</span><span class="va">taxon</span>,</span>
<span>            <span class="st">" ("</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">id</span><span class="op">$</span><span class="va">confidence</span>, digits<span class="op">=</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>            <span class="st">"%"</span>,</span>
<span>            sep<span class="op">=</span><span class="st">""</span>,</span>
<span>            collapse<span class="op">=</span><span class="st">"; "</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">output</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  uncultured bacterium; UWH_CL-010746_OTU-2. </span></span>
<span><span class="co">##         "Root (46%; unclassified_Root (46%" </span></span>
<span><span class="co">##  uncultured bacterium; UWH_CL-01079_OTU-21. </span></span>
<span><span class="co">##         "Root (39%; unclassified_Root (39%" </span></span>
<span><span class="co">##   uncultured bacterium; UWH_CL-08061_OTU-5. </span></span>
<span><span class="co">##     "Root (48.6%; unclassified_Root (48.6%" </span></span>
<span><span class="co">##  uncultured bacterium; Fin_CL-03079_OTU-21. </span></span>
<span><span class="co">##     "Root (31.7%; unclassified_Root (31.7%" </span></span>
<span><span class="co">## uncultured bacterium; UWL_CL-110518_OTU-11. </span></span>
<span><span class="co">##     "Root (49.3%; unclassified_Root (49.3%" </span></span>
<span><span class="co">## uncultured bacterium; UWL_CL-110548_OTU-32. </span></span>
<span><span class="co">##     "Root (54.1%; unclassified_Root (54.1%"</span></span></code></pre>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#writeLines(output, "&lt;&lt;path to output text file&gt;&gt;")</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="guaranteeing-repeatability">Guaranteeing repeatability<a class="anchor" aria-label="anchor" href="#guaranteeing-repeatability"></a>
</h3>
<p>The <em>IDTAXA</em> algorithm uses bootstrapping, which involves
random sampling to obtain a confidence score. For this reason, the
classifications are expected to change slightly if the classification
process is repeated with the same inputs. For some applications this
randomness is undesirable, and it can easily be avoided by setting the
random seed before classification. The process of setting and then
unsetting the seed in is straightforward:</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span> <span class="co"># choose a whole number as the random seed</span></span>
<span><span class="co"># then classify sequences with IdTaxa (not shown)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span> <span class="co"># return to the original state by unsetting the seed</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="creating-a-taxid-file">Creating a “taxid” file<a class="anchor" aria-label="anchor" href="#creating-a-taxid-file"></a>
</h2>
<p>The “taxid” file format supplies a table that can be used by
<code>LearnTaxa</code> to specify taxonomic ranks (e.g., phylum, class,
order, etc.) associated with each taxon. Previously we imported the rank
information from a plain text file containing 5 columns separate by
asterisks (“*“). An example of the contents of this file is:</p>
<p>The leftmost column is simply an index starting at zero. Next, there
is a column with each unique taxonomic name in the training set. The
third column contains a pointer to the index of each line’s parent. The
fourth column gives the rank level starting from “Root” at level 0. The
last column provides the taxonomic rank information that is used by
<code>LearnTaxa</code>.</p>
<p>The first line is always the same, and specifies that the “Root” rank
is index 0, has no parent (-1), and points to itself (index 0). The rest
of the lines must point to a positive index for their parent. For
example, the line for index 6 states that the genus “Ferrimicrobium”
exist within the family “Acidimicrobiaceae” (index 4) at rank level
5.</p>
<p>If you would like to create a custom “taxid” file for your training
set, the easiest way is to start with a set of taxonomic labels preceded
by prefixes indicating their rank. For example, the above “taxid” file
could be generated from these lines of text:</p>
<p>Then the following code will convert this text into the fields
required for the “taxid” file:</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ranks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readLines.html" class="external-link">readLines</a></span><span class="op">(</span><span class="st">"&lt;&lt;path to lines of text&gt;&gt;"</span><span class="op">)</span></span>
<span><span class="va">taxa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"domain"</span>, <span class="st">"phylum"</span>, <span class="st">"order"</span>, <span class="st">"family"</span>, <span class="st">"genus"</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"d__"</span>, <span class="st">"p__"</span>, <span class="st">"o__"</span>, <span class="st">"f__"</span>, <span class="st">"g__"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ranks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">ranks</span>, <span class="st">";"</span>, fix<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">count</span> <span class="op">&lt;-</span> <span class="fl">1L</span></span>
<span><span class="va">groups</span> <span class="op">&lt;-</span> <span class="st">"Root"</span></span>
<span><span class="va">index</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1L</span></span>
<span><span class="va">level</span> <span class="op">&lt;-</span> <span class="fl">0L</span></span>
<span><span class="va">rank</span> <span class="op">&lt;-</span> <span class="st">"rootrank"</span></span>
<span><span class="va">pBar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/txtProgressBar.html" class="external-link">txtProgressBar</a></span><span class="op">(</span>style<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">ranks</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">ranks</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">rank_level</span> <span class="op">&lt;-</span> <span class="va">taxa</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substring</a></span><span class="op">(</span><span class="va">ranks</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, <span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">]</span></span>
<span>        <span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substring</a></span><span class="op">(</span><span class="va">ranks</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, <span class="fl">4</span><span class="op">)</span></span>
<span>        <span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">groups</span><span class="op">==</span><span class="va">group</span> <span class="op">&amp;</span> <span class="va">rank</span><span class="op">==</span><span class="va">rank_level</span><span class="op">)</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="va">parent</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substring</a></span><span class="op">(</span><span class="va">ranks</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">j</span> <span class="op">-</span> <span class="fl">1</span><span class="op">]</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>                <span class="va">groups</span><span class="op">)</span></span>
<span>            <span class="kw">if</span> <span class="op">(</span><span class="va">j</span><span class="op">==</span><span class="fl">1</span> <span class="op">||</span> <span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="op">(</span><span class="va">parent</span> <span class="op">-</span> <span class="fl">1L</span><span class="op">)</span><span class="op">==</span><span class="va">index</span><span class="op">[</span><span class="va">w</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>                <span class="kw">next</span> <span class="co"># already included</span></span>
<span>        <span class="op">}</span></span>
<span>        </span>
<span>        <span class="va">count</span> <span class="op">&lt;-</span> <span class="va">count</span> <span class="op">+</span> <span class="fl">1L</span></span>
<span>        <span class="va">groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">groups</span>, <span class="va">group</span><span class="op">)</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="va">j</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="va">index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">index</span>, <span class="fl">0</span><span class="op">)</span></span>
<span>        <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>            <span class="va">parent</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substring</a></span><span class="op">(</span><span class="va">ranks</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">j</span> <span class="op">-</span> <span class="fl">1</span><span class="op">]</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>                <span class="va">groups</span><span class="op">)</span></span>
<span>            <span class="va">index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">index</span>,</span>
<span>                <span class="va">parent</span> <span class="op">-</span> <span class="fl">1L</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>        <span class="va">level</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">level</span>, <span class="va">j</span><span class="op">)</span></span>
<span>        <span class="va">rank</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">rank</span>, <span class="va">taxa</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/txtProgressBar.html" class="external-link">setTxtProgressBar</a></span><span class="op">(</span><span class="va">pBar</span>, <span class="va">i</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ranks</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"^[ ]+"</span>, <span class="st">""</span>, <span class="va">groups</span><span class="op">)</span></span>
<span><span class="va">groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"[ ]+$"</span>, <span class="st">""</span>, <span class="va">groups</span><span class="op">)</span></span>
<span></span>
<span><span class="va">taxid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">index</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1L</span><span class="op">)</span>, <span class="va">groups</span>, <span class="va">index</span>, <span class="va">level</span>, <span class="va">rank</span>, sep<span class="op">=</span><span class="st">"*"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">taxid</span>, n<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] "0*Root*-1*0*rootrank"          
[2] "1*Bacteria*0*1*domain"         
[3] "2*Actinobacteria*1*2*phylum"   
[4] "3*Acidimicrobiales*2*3*order"  
[5] "4*Acidimicrobiaceae*3*4*family"
[6] "5*Acidimicrobium*4*5*genus"    
[7] "6*Ferrimicrobium*4*5*genus"</code></pre>
<p>Now these lines of text can be written to a file to be imported as
the “taxid” file above.</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/writeLines.html" class="external-link">writeLines</a></span><span class="op">(</span><span class="va">taxid</span>,</span>
<span>    con<span class="op">=</span><span class="st">"&lt;&lt;path to taxid file&gt;&gt;"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="annotating-protein-sequences">Annotating Protein Sequences<a class="anchor" aria-label="anchor" href="#annotating-protein-sequences"></a>
</h2>
<p>The <em>IDTAXA</em> algorithm can also be used to classify amino acid
sequences into a taxonomy of genes, functions, or organisms. As an
example, we can train the classifier on the set of named genes from the
phylum Planctobacteria. Sets such as this can be constructed from
various databases, including <a href="https://www.uniprot.org/uniprot/?query=reviewed%7BSwissProt" class="external-link uri">https://www.uniprot.org/uniprot/?query=reviewed{SwissProt</a>}.
The example training sequences can be loaded with:</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,</span>
<span>    <span class="st">"PlanctobacteriaNamedGenes.fas.gz"</span>,</span>
<span>    package<span class="op">=</span><span class="st">"DECIPHER"</span><span class="op">)</span></span>
<span><span class="va">aa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Biostrings/man/XStringSet-io.html" class="external-link">readAAStringSet</a></span><span class="op">(</span><span class="va">fas</span><span class="op">)</span></span>
<span><span class="va">aa</span></span></code></pre></div>
<pre><code><span><span class="co">## AAStringSet object of length 2497:</span></span>
<span><span class="co">##        width seq                                            names               </span></span>
<span><span class="co">##    [1]   227 <span style="color: #000000; background-color: #FFD7D7;">MA</span><span style="color: #000000; background-color: #D7D7FF;">GP</span><span style="color: #000000; background-color: #AFD7FF;">KH</span><span style="color: #000000; background-color: #FFD7D7;">VLLV</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #AFD7FF;">H</span><span style="color: #000000; background-color: #D7FFD7;">W</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #D7FFD7;">FF</span><span style="color: #000000; background-color: #AFFFFF;">QT</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #FFD7FF;">E</span>...<span style="color: #000000; background-color: #FFD7D7;">V</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #D7FFD7;">Y</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #FFD7FF;">DD</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #AFD7FF;">KK</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #AFFFFF;">SQQ</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #AFFFFF;">T</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #AFFFFF;">S</span> A0A0H3MDW1|Root;N...</span></span>
<span><span class="co">##    [2]   394 <span style="color: #000000; background-color: #FFD7D7;">M</span><span style="color: #000000; background-color: #AFD7FF;">KR</span><span style="color: #000000; background-color: #AFFFFF;">N</span><span style="color: #000000; background-color: #D7D7FF;">P</span><span style="color: #000000; background-color: #AFD7FF;">H</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #FFD7D7;">V</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #AFFFFF;">T</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #AFFFFF;">N</span><span style="color: #000000; background-color: #D7FFD7;">Y</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #FFD7D7;">A</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #AFFFFF;">Q</span><span style="color: #000000; background-color: #AFD7FF;">KR</span>...<span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #AFD7FF;">KR</span><span style="color: #000000; background-color: #FFD7FF;">ED</span><span style="color: #000000; background-color: #FFD7D7;">ILAA</span><span style="color: #000000; background-color: #FFFFD7;">C</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #AFFFFF;">Q</span><span style="color: #000000; background-color: #FFD7D7;">MA</span><span style="color: #000000; background-color: #D7D7FF;">P</span><span style="color: #000000; background-color: #FFD7D7;">AL</span><span style="color: #000000; background-color: #AFFFFF;">QS</span> O84395|Root;2;6;1...</span></span>
<span><span class="co">##    [3]   195 <span style="color: #000000; background-color: #FFD7D7;">MA</span><span style="color: #000000; background-color: #D7FFD7;">Y</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #AFFFFF;">T</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #D7FFD7;">Y</span><span style="color: #000000; background-color: #D7D7FF;">P</span><span style="color: #000000; background-color: #AFFFFF;">T</span><span style="color: #000000; background-color: #FFD7D7;">LA</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #AFD7FF;">H</span><span style="color: #000000; background-color: #AFFFFF;">T</span><span style="color: #000000; background-color: #D7D7FF;">GG</span><span style="color: #000000; background-color: #FFD7D7;">I</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #FFD7FF;">DD</span>...<span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #FFFFD7;">C</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #AFFFFF;">T</span><span style="color: #000000; background-color: #FFD7D7;">AL</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #AFFFFF;">N</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #AFFFFF;">N</span><span style="color: #000000; background-color: #FFD7D7;">A</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #D7D7FF;">P</span><span style="color: #000000; background-color: #FFD7D7;">A</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #FFD7D7;">V</span><span style="color: #000000; background-color: #AFFFFF;">N</span> Q9Z6M7|Root;4;1;1...</span></span>
<span><span class="co">##    [4]   437 <span style="color: #000000; background-color: #FFD7D7;">MML</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #FFD7D7;">V</span><span style="color: #000000; background-color: #AFD7FF;">HR</span><span style="color: #000000; background-color: #FFD7D7;">I</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #FFFFD7;">C</span><span style="color: #000000; background-color: #D7FFD7;">FY</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #FFD7D7;">VVLV</span><span style="color: #000000; background-color: #FFFFD7;">C</span><span style="color: #000000; background-color: #FFD7D7;">A</span><span style="color: #000000; background-color: #D7FFD7;">F</span>...<span style="color: #000000; background-color: #AFFFFF;">T</span><span style="color: #000000; background-color: #FFD7D7;">A</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #AFFFFF;">T</span><span style="color: #000000; background-color: #D7FFD7;">W</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #FFD7D7;">AL</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #D7FFD7;">Y</span><span style="color: #000000; background-color: #FFD7D7;">I</span><span style="color: #000000; background-color: #D7D7FF;">P</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #D7FFD7;">Y</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #AFFFFF;">NS</span> Q46222|Root;2;4;9...</span></span>
<span><span class="co">##    [5]   539 <span style="color: #000000; background-color: #FFD7D7;">M</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #FFD7D7;">I</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #AFFFFF;">T</span><span style="color: #000000; background-color: #D7D7FF;">GG</span><span style="color: #000000; background-color: #FFD7D7;">VV</span><span style="color: #000000; background-color: #AFFFFF;">SS</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #AFFFFF;">T</span><span style="color: #000000; background-color: #FFD7D7;">A</span>...<span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #FFD7D7;">I</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #FFD7D7;">I</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #FFD7D7;">AA</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #FFD7D7;">A</span><span style="color: #000000; background-color: #D7FFD7;">Y</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #FFD7D7;">A</span><span style="color: #000000; background-color: #AFFFFF;">N</span><span style="color: #000000; background-color: #AFD7FF;">H</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #AFD7FF;">HR</span> Q59321|Root;6;3;4...</span></span>
<span><span class="co">##    ...   ... ...</span></span>
<span><span class="co">## [2493]  1038 <span style="color: #000000; background-color: #FFD7D7;">M</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #FFD7FF;">EE</span><span style="color: #000000; background-color: #FFD7D7;">VL</span><span style="color: #000000; background-color: #AFFFFF;">Q</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #FFD7FF;">DE</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #AFD7FF;">KK</span><span style="color: #000000; background-color: #FFD7D7;">VL</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #D7FFD7;">FW</span><span style="color: #000000; background-color: #AFFFFF;">Q</span>...<span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #AFFFFF;">T</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #D7FFD7;">W</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #AFFFFF;">N</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #D7D7FF;">P</span><span style="color: #000000; background-color: #AFFFFF;">T</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #FFD7D7;">III</span><span style="color: #000000; background-color: #AFD7FF;">KK</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #D7FFD7;">Y</span> Q6MDY1|Root;6;1;1...</span></span>
<span><span class="co">## [2494]   102 <span style="color: #000000; background-color: #FFD7D7;">MV</span><span style="color: #000000; background-color: #AFFFFF;">Q</span><span style="color: #000000; background-color: #FFD7D7;">IV</span><span style="color: #000000; background-color: #AFFFFF;">SQ</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #AFFFFF;">N</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #FFD7D7;">A</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #FFD7D7;">IA</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #FFD7D7;">LVLV</span><span style="color: #000000; background-color: #FFD7FF;">D</span>...<span style="color: #000000; background-color: #FFD7D7;">V</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #FFD7D7;">V</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #FFD7D7;">LV</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #FFD7D7;">LI</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #AFD7FF;">KH</span><span style="color: #000000; background-color: #AFFFFF;">Q</span> Q9PJK3|Root;NoEC;...</span></span>
<span><span class="co">## [2495]   224 <span style="color: #000000; background-color: #FFD7D7;">M</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #D7D7FF;">P</span><span style="color: #000000; background-color: #AFFFFF;">Q</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #D7D7FF;">P</span><span style="color: #000000; background-color: #D7FFD7;">YFW</span><span style="color: #000000; background-color: #FFD7FF;">ED</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #FFFFD7;">C</span><span style="color: #000000; background-color: #D7D7FF;">P</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #FFD7D7;">I</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #AFFFFF;">N</span><span style="color: #000000; background-color: #AFD7FF;">H</span>...<span style="color: #000000; background-color: #AFFFFF;">N</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #D7FFD7;">W</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #FFD7D7;">I</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #FFFFD7;">C</span><span style="color: #000000; background-color: #AFFFFF;">T</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #FFD7D7;">V</span><span style="color: #000000; background-color: #AFD7FF;">KR</span><span style="color: #000000; background-color: #FFD7D7;">V</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #FFD7D7;">I</span> Q9PL91|Root;2;1;1...</span></span>
<span><span class="co">## [2496]   427 <span style="color: #000000; background-color: #FFD7D7;">ML</span><span style="color: #000000; background-color: #AFD7FF;">RR</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #FFD7D7;">V</span><span style="color: #000000; background-color: #AFFFFF;">ST</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #FFD7D7;">LI</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #FFD7D7;">MV</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #D7FFD7;">Y</span><span style="color: #000000; background-color: #FFD7D7;">A</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #FFD7FF;">D</span>...<span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #FFD7D7;">IVI</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #AFD7FF;">KR</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #D7D7FF;">P</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #D7FFD7;">W</span><span style="color: #000000; background-color: #D7D7FF;">GG</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #D7D7FF;">P</span><span style="color: #000000; background-color: #AFFFFF;">NNQ</span> Q256H8|Root;NoEC;...</span></span>
<span><span class="co">## [2497]   344 <span style="color: #000000; background-color: #FFD7D7;">ML</span><span style="color: #000000; background-color: #AFFFFF;">T</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #AFFFFF;">SS</span><span style="color: #000000; background-color: #FFFFD7;">C</span><span style="color: #000000; background-color: #FFD7FF;">DE</span><span style="color: #000000; background-color: #AFFFFF;">T</span><span style="color: #000000; background-color: #FFD7D7;">A</span><span style="color: #000000; background-color: #FFFFD7;">C</span><span style="color: #000000; background-color: #FFD7D7;">ALV</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #FFD7D7;">A</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #D7D7FF;">G</span>...<span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #FFD7D7;">I</span><span style="color: #000000; background-color: #AFD7FF;">H</span><span style="color: #000000; background-color: #D7D7FF;">P</span><span style="color: #000000; background-color: #FFFFD7;">C</span><span style="color: #000000; background-color: #FFD7D7;">A</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #D7FFD7;">Y</span><span style="color: #000000; background-color: #AFD7FF;">H</span><span style="color: #000000; background-color: #D7FFD7;">W</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #FFD7D7;">I</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #FFD7D7;">A</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #D7D7FF;">P</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #D7D7FF;">P</span> Q822Y4|Root;2;3;1...</span></span></code></pre>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">aa</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "A0A0H3MDW1|Root;NoEC;chxR"        "O84395|Root;2;6;1;83;dapL"       </span></span>
<span><span class="co">## [3] "Q9Z6M7|Root;4;1;1;19;aaxB"        "Q46222|Root;2;4;99;Multiple;waaA"</span></span>
<span><span class="co">## [5] "Q59321|Root;6;3;4;2;pyrG"         "P0C0Z7|Root;NoEC;groL"</span></span></code></pre>
<p>Here, protein sequences are named by their enzyme commission (EC)
number and three or four-letter gene name. It is important to only train
the classifier with sequences having complete labels. In this case, we
will get rid of sequences without any EC number.</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aa</span> <span class="op">&lt;-</span> <span class="va">aa</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"Root;NoEC"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">aa</span><span class="op">)</span>, fixed<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">aa</span></span></code></pre></div>
<pre><code><span><span class="co">## AAStringSet object of length 1542:</span></span>
<span><span class="co">##        width seq                                            names               </span></span>
<span><span class="co">##    [1]   394 <span style="color: #000000; background-color: #FFD7D7;">M</span><span style="color: #000000; background-color: #AFD7FF;">KR</span><span style="color: #000000; background-color: #AFFFFF;">N</span><span style="color: #000000; background-color: #D7D7FF;">P</span><span style="color: #000000; background-color: #AFD7FF;">H</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #FFD7D7;">V</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #AFFFFF;">T</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #AFFFFF;">N</span><span style="color: #000000; background-color: #D7FFD7;">Y</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #FFD7D7;">A</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #AFFFFF;">Q</span><span style="color: #000000; background-color: #AFD7FF;">KR</span>...<span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #AFD7FF;">KR</span><span style="color: #000000; background-color: #FFD7FF;">ED</span><span style="color: #000000; background-color: #FFD7D7;">ILAA</span><span style="color: #000000; background-color: #FFFFD7;">C</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #AFFFFF;">Q</span><span style="color: #000000; background-color: #FFD7D7;">MA</span><span style="color: #000000; background-color: #D7D7FF;">P</span><span style="color: #000000; background-color: #FFD7D7;">AL</span><span style="color: #000000; background-color: #AFFFFF;">QS</span> O84395|Root;2;6;1...</span></span>
<span><span class="co">##    [2]   195 <span style="color: #000000; background-color: #FFD7D7;">MA</span><span style="color: #000000; background-color: #D7FFD7;">Y</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #AFFFFF;">T</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #D7FFD7;">Y</span><span style="color: #000000; background-color: #D7D7FF;">P</span><span style="color: #000000; background-color: #AFFFFF;">T</span><span style="color: #000000; background-color: #FFD7D7;">LA</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #AFD7FF;">H</span><span style="color: #000000; background-color: #AFFFFF;">T</span><span style="color: #000000; background-color: #D7D7FF;">GG</span><span style="color: #000000; background-color: #FFD7D7;">I</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #FFD7FF;">DD</span>...<span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #FFFFD7;">C</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #AFFFFF;">T</span><span style="color: #000000; background-color: #FFD7D7;">AL</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #AFFFFF;">N</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #AFFFFF;">N</span><span style="color: #000000; background-color: #FFD7D7;">A</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #D7D7FF;">P</span><span style="color: #000000; background-color: #FFD7D7;">A</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #FFD7D7;">V</span><span style="color: #000000; background-color: #AFFFFF;">N</span> Q9Z6M7|Root;4;1;1...</span></span>
<span><span class="co">##    [3]   437 <span style="color: #000000; background-color: #FFD7D7;">MML</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #FFD7D7;">V</span><span style="color: #000000; background-color: #AFD7FF;">HR</span><span style="color: #000000; background-color: #FFD7D7;">I</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #FFFFD7;">C</span><span style="color: #000000; background-color: #D7FFD7;">FY</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #FFD7D7;">VVLV</span><span style="color: #000000; background-color: #FFFFD7;">C</span><span style="color: #000000; background-color: #FFD7D7;">A</span><span style="color: #000000; background-color: #D7FFD7;">F</span>...<span style="color: #000000; background-color: #AFFFFF;">T</span><span style="color: #000000; background-color: #FFD7D7;">A</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #AFFFFF;">T</span><span style="color: #000000; background-color: #D7FFD7;">W</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #FFD7D7;">AL</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #D7FFD7;">Y</span><span style="color: #000000; background-color: #FFD7D7;">I</span><span style="color: #000000; background-color: #D7D7FF;">P</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #D7FFD7;">Y</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #AFFFFF;">NS</span> Q46222|Root;2;4;9...</span></span>
<span><span class="co">##    [4]   539 <span style="color: #000000; background-color: #FFD7D7;">M</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #FFD7D7;">I</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #AFFFFF;">T</span><span style="color: #000000; background-color: #D7D7FF;">GG</span><span style="color: #000000; background-color: #FFD7D7;">VV</span><span style="color: #000000; background-color: #AFFFFF;">SS</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #AFFFFF;">T</span><span style="color: #000000; background-color: #FFD7D7;">A</span>...<span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #FFD7D7;">I</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #FFD7D7;">I</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #FFD7D7;">AA</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #FFD7D7;">A</span><span style="color: #000000; background-color: #D7FFD7;">Y</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #FFD7D7;">A</span><span style="color: #000000; background-color: #AFFFFF;">N</span><span style="color: #000000; background-color: #AFD7FF;">H</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #AFD7FF;">HR</span> Q59321|Root;6;3;4...</span></span>
<span><span class="co">##    [5]    92 <span style="color: #000000; background-color: #FFD7D7;">M</span><span style="color: #000000; background-color: #AFFFFF;">Q</span><span style="color: #000000; background-color: #FFD7D7;">V</span><span style="color: #000000; background-color: #AFFFFF;">N</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #D7FFD7;">YF</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #AFFFFF;">N</span><span style="color: #000000; background-color: #FFD7D7;">V</span><span style="color: #000000; background-color: #AFFFFF;">TS</span><span style="color: #000000; background-color: #FFD7D7;">IA</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #AFFFFF;">N</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #AFD7FF;">R</span>...<span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #FFD7D7;">A</span><span style="color: #000000; background-color: #AFFFFF;">NQ</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #AFFFFF;">Q</span><span style="color: #000000; background-color: #FFD7D7;">V</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #FFD7D7;">VI</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #D7D7FF;">P</span><span style="color: #000000; background-color: #AFFFFF;">T</span><span style="color: #000000; background-color: #FFD7D7;">A</span><span style="color: #000000; background-color: #D7FFD7;">Y</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #FFFFD7;">C</span><span style="color: #000000; background-color: #D7FFD7;">FY</span><span style="color: #000000; background-color: #AFFFFF;">S</span> Q7USA1|Root;2;4;2...</span></span>
<span><span class="co">##    ...   ... ...</span></span>
<span><span class="co">## [1538]  1036 <span style="color: #000000; background-color: #FFD7D7;">M</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #AFFFFF;">N</span><span style="color: #000000; background-color: #FFD7FF;">ED</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #FFD7D7;">I</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #FFD7D7;">I</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #FFD7D7;">A</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #FFD7FF;">EE</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #FFD7D7;">IL</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #D7FFD7;">FW</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #FFD7FF;">E</span>...<span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #FFD7FF;">EE</span><span style="color: #000000; background-color: #D7FFD7;">W</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #FFD7D7;">I</span><span style="color: #000000; background-color: #AFFFFF;">N</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #AFD7FF;">H</span><span style="color: #000000; background-color: #FFD7D7;">AV</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #FFD7D7;">VL</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #FFD7D7;">V</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #AFD7FF;">R</span> B0BB05|Root;6;1;1...</span></span>
<span><span class="co">## [1539]   342 <span style="color: #000000; background-color: #FFD7D7;">M</span><span style="color: #000000; background-color: #AFFFFF;">T</span><span style="color: #000000; background-color: #FFD7D7;">I</span><span style="color: #000000; background-color: #AFFFFF;">Q</span><span style="color: #000000; background-color: #FFD7FF;">EE</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #FFD7D7;">AV</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #AFFFFF;">QQ</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #FFFFD7;">C</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #FFD7D7;">V</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #FFD7D7;">LA</span><span style="color: #000000; background-color: #AFD7FF;">H</span>...<span style="color: #000000; background-color: #D7FFD7;">Y</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #FFD7D7;">I</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #FFD7D7;">I</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #AFFFFF;">N</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #AFFFFF;">Q</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #AFFFFF;">S</span> O84843|Root;6;1;1...</span></span>
<span><span class="co">## [1540]  1038 <span style="color: #000000; background-color: #FFD7D7;">M</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #FFD7FF;">EE</span><span style="color: #000000; background-color: #FFD7D7;">VL</span><span style="color: #000000; background-color: #AFFFFF;">Q</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #FFD7FF;">DE</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #AFD7FF;">KK</span><span style="color: #000000; background-color: #FFD7D7;">VL</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #D7FFD7;">FW</span><span style="color: #000000; background-color: #AFFFFF;">Q</span>...<span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #AFFFFF;">T</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #D7FFD7;">W</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #AFFFFF;">N</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #D7D7FF;">P</span><span style="color: #000000; background-color: #AFFFFF;">T</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #FFD7D7;">III</span><span style="color: #000000; background-color: #AFD7FF;">KK</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #D7FFD7;">Y</span> Q6MDY1|Root;6;1;1...</span></span>
<span><span class="co">## [1541]   224 <span style="color: #000000; background-color: #FFD7D7;">M</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #D7D7FF;">P</span><span style="color: #000000; background-color: #AFFFFF;">Q</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #D7D7FF;">P</span><span style="color: #000000; background-color: #D7FFD7;">YFW</span><span style="color: #000000; background-color: #FFD7FF;">ED</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #FFFFD7;">C</span><span style="color: #000000; background-color: #D7D7FF;">P</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #FFD7D7;">I</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #AFFFFF;">N</span><span style="color: #000000; background-color: #AFD7FF;">H</span>...<span style="color: #000000; background-color: #AFFFFF;">N</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #D7FFD7;">W</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #FFD7D7;">I</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #FFFFD7;">C</span><span style="color: #000000; background-color: #AFFFFF;">T</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #FFD7D7;">V</span><span style="color: #000000; background-color: #AFD7FF;">KR</span><span style="color: #000000; background-color: #FFD7D7;">V</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #FFD7D7;">I</span> Q9PL91|Root;2;1;1...</span></span>
<span><span class="co">## [1542]   344 <span style="color: #000000; background-color: #FFD7D7;">ML</span><span style="color: #000000; background-color: #AFFFFF;">T</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #AFFFFF;">SS</span><span style="color: #000000; background-color: #FFFFD7;">C</span><span style="color: #000000; background-color: #FFD7FF;">DE</span><span style="color: #000000; background-color: #AFFFFF;">T</span><span style="color: #000000; background-color: #FFD7D7;">A</span><span style="color: #000000; background-color: #FFFFD7;">C</span><span style="color: #000000; background-color: #FFD7D7;">ALV</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #FFD7D7;">A</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #D7D7FF;">G</span>...<span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #FFD7D7;">I</span><span style="color: #000000; background-color: #AFD7FF;">H</span><span style="color: #000000; background-color: #D7D7FF;">P</span><span style="color: #000000; background-color: #FFFFD7;">C</span><span style="color: #000000; background-color: #FFD7D7;">A</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #D7FFD7;">Y</span><span style="color: #000000; background-color: #AFD7FF;">H</span><span style="color: #000000; background-color: #D7FFD7;">W</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #FFD7D7;">I</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #FFD7D7;">A</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #D7D7FF;">P</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #D7D7FF;">P</span> Q822Y4|Root;2;3;1...</span></span></code></pre>
<p>Since this taxonomy contains widely disparate sequences, we would not
expect tree descent to be useful. We can disable tree descent by setting
<code>maxChildren</code> to <code>1</code> in
<code>LearnTaxa</code>.</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trainingSet</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/LearnTaxa.html">LearnTaxa</a></span><span class="op">(</span>train<span class="op">=</span><span class="va">aa</span>,</span>
<span>    taxonomy<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">aa</span><span class="op">)</span>,</span>
<span>    maxChildren<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## ================================================================================</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Time difference of 0.62 secs</span></span></code></pre>
<p>Next we need a set of query sequences to classify. To this end, we
will use a representative genome of the <em>Chlamydia trachomatis</em>
species, a member of the Planctobacteria phylum. We can find genes in
the genome using the <strong>DECIPHER</strong> function
<code>FindGenes</code>.</p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,</span>
<span>    <span class="st">"Chlamydia_trachomatis_NC_000117.fas.gz"</span>,</span>
<span>    package<span class="op">=</span><span class="st">"DECIPHER"</span><span class="op">)</span></span>
<span><span class="va">genome</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Biostrings/man/XStringSet-io.html" class="external-link">readDNAStringSet</a></span><span class="op">(</span><span class="va">fas</span><span class="op">)</span></span>
<span><span class="va">genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/FindGenes.html">FindGenes</a></span><span class="op">(</span><span class="va">genome</span>, verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ExtractGenes.html">ExtractGenes</a></span><span class="op">(</span><span class="va">genes</span>, <span class="va">genome</span>, type<span class="op">=</span><span class="st">"AAStringSet"</span><span class="op">)</span></span>
<span><span class="va">test</span></span></code></pre></div>
<pre><code><span><span class="co">## AAStringSet object of length 897:</span></span>
<span><span class="co">##       width seq</span></span>
<span><span class="co">##   [1]   392 <span style="color: #000000; background-color: #FFD7D7;">AAA</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #FFD7D7;">IA</span><span style="color: #000000; background-color: #AFD7FF;">KR</span><span style="color: #000000; background-color: #D7FFD7;">W</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #AFFFFF;">Q</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #FFD7D7;">V</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #AFFFFF;">Q</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #FFD7D7;">AA</span><span style="color: #000000; background-color: #AFD7FF;">RK</span><span style="color: #000000; background-color: #FFD7D7;">LL</span><span style="color: #000000; background-color: #AFFFFF;">N</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #D7D7FF;">P</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #AFD7FF;">R</span>...<span style="color: #000000; background-color: #AFFFFF;">Q</span><span style="color: #000000; background-color: #FFD7D7;">V</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #FFD7D7;">IL</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #FFD7D7;">ML</span><span style="color: #000000; background-color: #AFFFFF;">TN</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #AFFFFF;">SQT</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #FFD7D7;">LM</span><span style="color: #000000; background-color: #AFD7FF;">RR</span><span style="color: #000000; background-color: #D7FFD7;">W</span><span style="color: #000000; background-color: #AFFFFF;">N</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #FFD7D7;">V</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #FFD7FF;">E</span>*</span></span>
<span><span class="co">##   [2]    91 <span style="color: #000000; background-color: #FFD7D7;">ML</span><span style="color: #000000; background-color: #FFFFD7;">C</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #FFD7D7;">V</span><span style="color: #000000; background-color: #FFFFD7;">C</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #AFFFFF;">SS</span><span style="color: #000000; background-color: #FFD7D7;">LIVVL</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #FFD7D7;">AI</span><span style="color: #000000; background-color: #AFFFFF;">NT</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #FFD7D7;">IL</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #FFD7D7;">V</span><span style="color: #000000; background-color: #AFFFFF;">T</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #D7FFD7;">Y</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #FFD7D7;">V</span><span style="color: #000000; background-color: #AFFFFF;">N</span><span style="color: #000000; background-color: #FFD7D7;">L</span>...<span style="color: #000000; background-color: #FFFFD7;">C</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #AFFFFF;">N</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #FFFFD7;">CC</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #AFD7FF;">KKRH</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #FFFFD7;">CC</span><span style="color: #000000; background-color: #AFFFFF;">SS</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #D7D7FF;">GG</span><span style="color: #000000; background-color: #D7FFD7;">Y</span><span style="color: #000000; background-color: #AFD7FF;">HHHH</span><span style="color: #000000; background-color: #FFD7D7;">M</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #FFD7FF;">E</span>*</span></span>
<span><span class="co">##   [3]   101 <span style="color: #000000; background-color: #FFD7D7;">M</span><span style="color: #000000; background-color: #AFFFFF;">T</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #D7FFD7;">Y</span><span style="color: #000000; background-color: #FFD7D7;">V</span><span style="color: #000000; background-color: #AFFFFF;">N</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #FFD7FF;">EE</span><span style="color: #000000; background-color: #FFD7D7;">II</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #FFD7D7;">LA</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #AFFFFF;">N</span><span style="color: #000000; background-color: #FFD7D7;">AAL</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #FFD7FF;">ED</span><span style="color: #000000; background-color: #FFD7D7;">A</span><span style="color: #000000; background-color: #AFD7FF;">H</span><span style="color: #000000; background-color: #FFD7D7;">V</span><span style="color: #000000; background-color: #FFD7FF;">EE</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #FFD7D7;">V</span><span style="color: #000000; background-color: #AFFFFF;">TS</span>...<span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #FFD7D7;">MV</span><span style="color: #000000; background-color: #AFFFFF;">TS</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #AFFFFF;">TQ</span><span style="color: #000000; background-color: #FFD7FF;">EE</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #AFFFFF;">SN</span><span style="color: #000000; background-color: #FFD7D7;">V</span><span style="color: #000000; background-color: #D7D7FF;">P</span><span style="color: #000000; background-color: #FFD7D7;">V</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #D7D7FF;">GG</span><span style="color: #000000; background-color: #FFD7D7;">LV</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #FFD7D7;">V</span><span style="color: #000000; background-color: #D7D7FF;">P</span><span style="color: #000000; background-color: #AFFFFF;">T</span><span style="color: #000000; background-color: #FFD7D7;">VI</span><span style="color: #000000; background-color: #AFD7FF;">K</span>*</span></span>
<span><span class="co">##   [4]   492 <span style="color: #000000; background-color: #FFD7D7;">M</span><span style="color: #000000; background-color: #D7FFD7;">Y</span><span style="color: #000000; background-color: #AFD7FF;">RK</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #FFD7D7;">AL</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #FFD7D7;">AVV</span><span style="color: #000000; background-color: #AFFFFF;">N</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #FFD7D7;">V</span><span style="color: #000000; background-color: #AFFFFF;">T</span><span style="color: #000000; background-color: #FFD7D7;">AI</span><span style="color: #000000; background-color: #AFFFFF;">T</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #D7FFD7;">YFY</span><span style="color: #000000; background-color: #AFD7FF;">HR</span><span style="color: #000000; background-color: #FFD7D7;">I</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #AFFFFF;">S</span>...<span style="color: #000000; background-color: #FFD7D7;">I</span><span style="color: #000000; background-color: #FFFFD7;">C</span><span style="color: #000000; background-color: #AFFFFF;">Q</span><span style="color: #000000; background-color: #FFD7D7;">V</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #D7FFD7;">Y</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #AFFFFF;">Q</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #AFD7FF;">H</span><span style="color: #000000; background-color: #AFFFFF;">SQ</span><span style="color: #000000; background-color: #FFD7D7;">I</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #AFFFFF;">Q</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #D7FFD7;">Y</span><span style="color: #000000; background-color: #D7D7FF;">P</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #FFD7D7;">AV</span><span style="color: #000000; background-color: #AFFFFF;">N</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #D7D7FF;">GG</span><span style="color: #000000; background-color: #FFD7D7;">I</span><span style="color: #000000; background-color: #FFD7FF;">E</span>*</span></span>
<span><span class="co">##   [5]   489 <span style="color: #000000; background-color: #FFD7D7;">M</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #FFD7D7;">IA</span><span style="color: #000000; background-color: #AFD7FF;">H</span><span style="color: #000000; background-color: #AFFFFF;">T</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #D7FFD7;">W</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #FFD7D7;">VI</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #FFD7D7;">V</span><span style="color: #000000; background-color: #AFD7FF;">H</span><span style="color: #000000; background-color: #FFD7D7;">V</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #AFFFFF;">NT</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #D7D7FF;">P</span><span style="color: #000000; background-color: #FFD7D7;">A</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #AFFFFF;">N</span><span style="color: #000000; background-color: #AFD7FF;">H</span>...<span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #FFD7D7;">LV</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #AFFFFF;">Q</span><span style="color: #000000; background-color: #FFD7D7;">IM</span><span style="color: #000000; background-color: #AFD7FF;">KR</span><span style="color: #000000; background-color: #AFFFFF;">T</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #FFD7D7;">A</span><span style="color: #000000; background-color: #D7D7FF;">PP</span><span style="color: #000000; background-color: #AFD7FF;">KR</span><span style="color: #000000; background-color: #FFD7D7;">V</span><span style="color: #000000; background-color: #AFFFFF;">N</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #FFD7D7;">LLLAAM</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #FFD7D7;">M</span>*</span></span>
<span><span class="co">##   ...   ... ...</span></span>
<span><span class="co">## [893]  1017 <span style="color: #000000; background-color: #FFD7D7;">M</span><span style="color: #000000; background-color: #D7D7FF;">P</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #AFFFFF;">STS</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #FFFFD7;">C</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #FFD7D7;">LA</span><span style="color: #000000; background-color: #FFFFD7;">C</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #FFFFD7;">C</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #D7FFD7;">Y</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #D7FFD7;">Y</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #FFD7D7;">A</span><span style="color: #000000; background-color: #AFFFFF;">SS</span><span style="color: #000000; background-color: #D7D7FF;">P</span><span style="color: #000000; background-color: #AFFFFF;">Q</span><span style="color: #000000; background-color: #FFD7D7;">VL</span><span style="color: #000000; background-color: #AFFFFF;">T</span><span style="color: #000000; background-color: #D7D7FF;">P</span><span style="color: #000000; background-color: #AFFFFF;">N</span>...<span style="color: #000000; background-color: #AFD7FF;">HH</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #FFD7D7;">A</span><span style="color: #000000; background-color: #D7FFD7;">Y</span><span style="color: #000000; background-color: #FFD7D7;">M</span><span style="color: #000000; background-color: #AFFFFF;">N</span><span style="color: #000000; background-color: #D7FFD7;">Y</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #FFD7D7;">A</span><span style="color: #000000; background-color: #AFD7FF;">RRR</span><span style="color: #000000; background-color: #AFFFFF;">QT</span><span style="color: #000000; background-color: #FFD7D7;">A</span><span style="color: #000000; background-color: #AFD7FF;">H</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #FFD7D7;">V</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #FFD7D7;">M</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #AFFFFF;">N</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #FFD7D7;">I</span><span style="color: #000000; background-color: #D7FFD7;">F</span>*</span></span>
<span><span class="co">## [894]   101 <span style="color: #000000; background-color: #FFD7D7;">MLA</span><span style="color: #000000; background-color: #AFFFFF;">T</span><span style="color: #000000; background-color: #FFD7D7;">I</span><span style="color: #000000; background-color: #AFD7FF;">KK</span><span style="color: #000000; background-color: #FFD7D7;">I</span><span style="color: #000000; background-color: #AFFFFF;">T</span><span style="color: #000000; background-color: #FFD7D7;">VLLL</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #AFD7FF;">KRK</span><span style="color: #000000; background-color: #FFD7D7;">A</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #FFD7D7;">I</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #FFD7D7;">I</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #D7FFD7;">Y</span><span style="color: #000000; background-color: #FFFFD7;">C</span><span style="color: #000000; background-color: #FFD7D7;">ALAL</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #FFD7D7;">AV</span><span style="color: #000000; background-color: #FFD7FF;">E</span>...<span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #FFD7D7;">A</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #FFD7D7;">A</span><span style="color: #000000; background-color: #AFFFFF;">Q</span><span style="color: #000000; background-color: #FFD7D7;">V</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #FFD7D7;">LA</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #FFD7D7;">LML</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #D7FFD7;">YW</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #FFFFD7;">C</span><span style="color: #000000; background-color: #AFD7FF;">KK</span><span style="color: #000000; background-color: #FFD7D7;">I</span>*</span></span>
<span><span class="co">## [895]   879 <span style="color: #000000; background-color: #FFD7D7;">M</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #D7D7FF;">P</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #AFD7FF;">H</span><span style="color: #000000; background-color: #FFD7D7;">M</span><span style="color: #000000; background-color: #AFFFFF;">N</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #FFFFD7;">CC</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #FFFFD7;">C</span><span style="color: #000000; background-color: #FFD7D7;">AAIL</span><span style="color: #000000; background-color: #AFFFFF;">SST</span><span style="color: #000000; background-color: #FFD7D7;">AVL</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #AFFFFF;">Q</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #D7D7FF;">P</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #AFFFFF;">T</span><span style="color: #000000; background-color: #FFD7D7;">AL</span>...<span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #AFD7FF;">HR</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #AFFFFF;">QT</span><span style="color: #000000; background-color: #FFD7D7;">LL</span><span style="color: #000000; background-color: #AFFFFF;">N</span><span style="color: #000000; background-color: #FFD7D7;">V</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #D7FFD7;">Y</span><span style="color: #000000; background-color: #FFD7D7;">VL</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #AFFFFF;">QS</span><span style="color: #000000; background-color: #AFD7FF;">H</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #D7FFD7;">Y</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #AFFFFF;">TT</span><span style="color: #000000; background-color: #D7FFD7;">Y</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #D7FFD7;">F</span>*</span></span>
<span><span class="co">## [896]    32 <span style="color: #000000; background-color: #FFD7D7;">M</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #AFD7FF;">KK</span><span style="color: #000000; background-color: #AFFFFF;">SNN</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #AFFFFF;">QT</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #AFFFFF;">SS</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #FFD7D7;">AL</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #AFD7FF;">H</span><span style="color: #000000; background-color: #FFD7D7;">V</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #AFFFFF;">Q</span><span style="color: #000000; background-color: #FFD7FF;">DEE</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #AFD7FF;">RK</span><span style="color: #000000; background-color: #FFD7D7;">I</span><span style="color: #000000; background-color: #D7FFD7;">F</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #FFD7D7;">L</span>*</span></span>
<span><span class="co">## [897]   200 <span style="color: #000000; background-color: #FFD7D7;">M</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #FFD7D7;">I</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #FFD7D7;">V</span><span style="color: #000000; background-color: #D7D7FF;">GG</span><span style="color: #000000; background-color: #AFFFFF;">N</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #AFFFFF;">NS</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #FFD7D7;">I</span><span style="color: #000000; background-color: #D7D7FF;">P</span><span style="color: #000000; background-color: #AFFFFF;">S</span><span style="color: #000000; background-color: #AFD7FF;">H</span><span style="color: #000000; background-color: #AFFFFF;">N</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #AFFFFF;">SN</span><span style="color: #000000; background-color: #AFD7FF;">RR</span><span style="color: #000000; background-color: #AFFFFF;">SQNT</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #AFFFFF;">NN</span>...<span style="color: #000000; background-color: #AFFFFF;">N</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #FFD7D7;">V</span><span style="color: #000000; background-color: #AFFFFF;">N</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #FFD7D7;">A</span><span style="color: #000000; background-color: #AFD7FF;">R</span><span style="color: #000000; background-color: #FFD7D7;">LMAA</span><span style="color: #000000; background-color: #D7FFD7;">Y</span><span style="color: #000000; background-color: #AFFFFF;">TS</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #FFFFD7;">C</span><span style="color: #000000; background-color: #FFD7D7;">A</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #AFD7FF;">H</span><span style="color: #000000; background-color: #FFD7D7;">L</span><span style="color: #000000; background-color: #FFD7FF;">E</span><span style="color: #000000; background-color: #FFD7D7;">A</span><span style="color: #000000; background-color: #AFFFFF;">N</span><span style="color: #000000; background-color: #AFD7FF;">K</span><span style="color: #000000; background-color: #FFD7D7;">LA</span><span style="color: #000000; background-color: #D7D7FF;">GP</span><span style="color: #000000; background-color: #FFD7FF;">D</span><span style="color: #000000; background-color: #D7D7FF;">G</span><span style="color: #000000; background-color: #FFD7D7;">V</span></span></span></code></pre>
<p>Now, we can take advantage of the fact that our training and testing
sets are composed of full-length sequences by setting
<code>fullLength</code> to <code>0.99</code> in <code>IdTaxa</code>.
This will automatically infer the expected length variability among
proteins, and filter potential classifications to only those within a
reasonable length range. Furthermore, we will lower the
<code>threshold</code> to 50%, the recommended value for protein
sequences.</p>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/IdTaxa.html">IdTaxa</a></span><span class="op">(</span><span class="va">test</span>,</span>
<span>    <span class="va">trainingSet</span>,</span>
<span>    fullLength<span class="op">=</span><span class="fl">0.99</span>,</span>
<span>    threshold<span class="op">=</span><span class="fl">50</span>,</span>
<span>    processors<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## ================================================================================</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Time difference of 1.52 secs</span></span></code></pre>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ids</span></span></code></pre></div>
<pre><code><span><span class="co">##   A test set of class 'Taxa' with length 897</span></span>
<span><span class="co">##       confidence taxon</span></span>
<span><span class="co">##   [1]         8% Root; unclassified_Root                                        </span></span>
<span><span class="co">##   [2]         0% Root; unclassified_Root                                        </span></span>
<span><span class="co">##   [3]        99% Root; 6; 3; 5; -; gatC                                         </span></span>
<span><span class="co">##   [4]       100% Root; 6; 3; 5; 7; gatA                                         </span></span>
<span><span class="co">##   [5]        99% Root; 6; 3; 5; -; gatB                                         </span></span>
<span><span class="co">##   ...        ... ...</span></span>
<span><span class="co">## [893]         5% Root; unclassified_Root                                        </span></span>
<span><span class="co">## [894]         3% Root; unclassified_Root                                        </span></span>
<span><span class="co">## [895]         8% Root; unclassified_Root                                        </span></span>
<span><span class="co">## [896]         0% Root; unclassified_Root                                        </span></span>
<span><span class="co">## [897]         8% Root; unclassified_Root</span></span></code></pre>
<p>Since only about a third of the proteins are classifiable in this
dataset, we can display the subset of genes that did not belong to
“unclassified_Root”. To make the plot more interesting, we will subset
to the first EC number.</p>
<p>We see that most genes either are not placed in a class with an EC
number or belong to EC 2 (Transferases) or EC 3 (Hydrolases).</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Erik Wright.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
