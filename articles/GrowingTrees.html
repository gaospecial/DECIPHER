<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="DECIPHER">
<title>Growing phylogenetic trees with TreeLine • DECIPHER</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Growing phylogenetic trees with TreeLine">
<meta property="og:description" content="DECIPHER">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">DECIPHER</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.29.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/ArtOfAlignmentInR.html">The Art of Multiple Sequence Alignment in R</a>
    <a class="dropdown-item" href="../articles/ClassifySequences.html">Classify Sequences</a>
    <a class="dropdown-item" href="../articles/ClusteringSequences.html">Upsize your clustering with Clusterize</a>
    <a class="dropdown-item" href="../articles/DECIPHERing.html">Getting Started DECIPHERing</a>
    <a class="dropdown-item" href="../articles/DesignMicroarray.html">Design Microarray Probes</a>
    <a class="dropdown-item" href="../articles/DesignPrimers.html">Design Group-Specific Primers</a>
    <a class="dropdown-item" href="../articles/DesignProbes.html">Design Group-Specific FISH Probes</a>
    <a class="dropdown-item" href="../articles/DesignSignatures.html">Design Primers That Yield Group-Specific Signatures</a>
    <a class="dropdown-item" href="../articles/FindChimeras.html">Finding Chimeric Sequences</a>
    <a class="dropdown-item" href="../articles/FindingGenes.html">The Magic of Gene Finding</a>
    <a class="dropdown-item" href="../articles/FindingNonCodingRNAs.html">The Double Life of RNA: Uncovering Non-Coding RNAs</a>
    <a class="dropdown-item" href="../articles/GrowingTrees.html">Growing phylogenetic trees with TreeLine</a>
    <a class="dropdown-item" href="../articles/RepeatRepeat.html">Repeat, Repeat!</a>
    <a class="dropdown-item" href="../articles/normal.html">normal</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Growing phylogenetic trees with TreeLine</h1>
                        <h4 data-toc-skip class="author">Erik S.
Wright</h4>
            
            <h4 data-toc-skip class="date">2023-08-24</h4>
      
      
      <div class="d-none name"><code>GrowingTrees.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This document describes how to grow phylogenetic trees using the
<code>TreeLine</code> function in the <strong>DECIPHER</strong> package.
<code>TreeLine</code> takes as input a set of aligned nucleotide or
amino acid sequences and returns a phylogenetic tree (i.e.,
<em>dendrogram</em> object) as output. This vignette focuses on building
maximum likelihood (ML) and maximum parsimony (MP) phylogenetic trees
starting from sequences, but <code>TreeLine</code> can also be used to
build additive trees from a distance matrix.</p>
<p>Why is the function called <code>TreeLine</code>? The goal of
<code>TreeLine</code> is to find the most likely/parsimonious tree for a
given sequence alignment. There are often many trees with nearly maximal
likelihood/parsimony. Therefore, <code>TreeLine</code> seeks to find a
tree as close as possible to the treeline, analogous to how no trees can
grow above the treeline on a mountain.</p>
<p>Why use <code>TreeLine</code> versus other programs? The
<code>TreeLine</code> function is designed to return an excellent
phylogenetic tree with minimal user intervention. Many tree building
programs have a large set of complex options for niche applications. In
contrast, <code>TreeLine</code> simply builds a great tree when relying
on its defaults. This vignette is intended to get you started and
introduce additional options/functions that might be useful.</p>
<p>TreeLine uses multi-start optimization followed by hill-climbing to
find the highest trees on the likelihood or parsimony landscapes. Since
TreeLine is a stochastic optimizer, it optimizes many trees to prevent
luck from influencing the final result. The main difference from most
other approaches to tree optimization is that TreeLine heavily uses past
trees to generate new trees as it optimizes. With any luck it’ll find
the treeline!</p>
</div>
<div class="section level2">
<h2 id="performance-considerations">Performance Considerations<a class="anchor" aria-label="anchor" href="#performance-considerations"></a>
</h2>
<p>Finding a tree with very high likelihood/parsimony is no easy feat.
<code>TreeLine</code> systematically optimizes hundreds to thousands of
candidate trees before returning the best one. This takes time, but
there are things you can do to make it go faster.</p>
<ul>
<li>Only use the sequences you need: <code>TreeLine</code> scales a bit
worse than quadratically with the number of sequences. Hence, limiting
the number of sequences is a worthwhile consideration. In particular,
always eliminate redundant sequences, as shown below, and remove any
sequences that are not necessary. This concern is shared for all tree
building programs, and <code>TreeLine</code> is no exception.</li>
<li>Set a timeout: The <code>maxTime</code> argument specifies the
(approximate) maximum number of hours you are willing to let
<code>TreeLine</code> run. If you are concerned about the code running
too long then simply specify this argument.</li>
<li>Compile with OpenMP support: Significant speed-ups can be achieved
with multi-threading using OpenMP. See the “Getting Started DECIPHERing”
vignette for how to do this on your computer platform. Then you only
need to set the argument <code>processors=NULL</code> and
<code>TreeLine</code> will use all available processors.</li>
</ul>
</div>
<div class="section level2">
<h2 id="growing-a-phylogenetic-tree">Growing a Phylogenetic Tree<a class="anchor" aria-label="anchor" href="#growing-a-phylogenetic-tree"></a>
</h2>
<p><code>TreeLine</code> takes as input a multiple sequence alignment
when constructing a maximum likelihood or maximum parsimony phylogenetic
tree. Multiple sequence alignments can be constructed from a set of
(unaligned) sequences using <code>AlignSeqs</code> or related functions.
<code>TreeLine</code> will optimize trees for amino acid (i.e.,
<code>AAStringSet</code>) or nucleotide (i.e., <code>DNAStringSet</code>
or <code>RNAStringSet</code>) sequences. Here, we are going to use a set
of sequences that is included with <strong>DECIPHER</strong>. These
sequences are from the internal transcribed spacer (ITS) between the 16S
and 23S ribosomal RNA genes in several <em>Streptomyces</em>
species.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">DECIPHER</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: Biostrings</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: BiocGenerics</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'BiocGenerics'</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     IQR, mad, sd, var, xtabs</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     anyDuplicated, aperm, append, as.data.frame, basename, cbind,</span></span>
<span><span class="co">##     colnames, dirname, do.call, duplicated, eval, evalq, Filter, Find,</span></span>
<span><span class="co">##     get, grep, grepl, intersect, is.unsorted, lapply, Map, mapply,</span></span>
<span><span class="co">##     match, mget, order, paste, pmax, pmax.int, pmin, pmin.int,</span></span>
<span><span class="co">##     Position, rank, rbind, Reduce, rownames, sapply, setdiff, sort,</span></span>
<span><span class="co">##     table, tapply, union, unique, unsplit, which.max, which.min</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: S4Vectors</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: stats4</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'S4Vectors'</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:utils':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     findMatches</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     expand.grid, I, unname</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: IRanges</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: XVector</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: GenomeInfoDb</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'Biostrings'</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     strsplit</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: RSQLite</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: parallel</span></span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># specify the path to your sequence file:</span></span>
<span><span class="va">fas</span> <span class="op">&lt;-</span> <span class="st">"&lt;&lt;path to FASTA file&gt;&gt;"</span></span>
<span><span class="co"># OR find the example sequence file used in this tutorial:</span></span>
<span><span class="va">fas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"Streptomyces_ITS_aligned.fas"</span>, package<span class="op">=</span><span class="st">"DECIPHER"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">seqs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Biostrings/man/XStringSet-io.html" class="external-link">readDNAStringSet</a></span><span class="op">(</span><span class="va">fas</span><span class="op">)</span> <span class="co"># use readAAStringSet for amino acid sequences</span></span>
<span><span class="va">seqs</span> <span class="co"># the aligned sequences</span></span></code></pre></div>
<pre><code><span><span class="co">## DNAStringSet object of length 88:</span></span>
<span><span class="co">##      width seq                                              names               </span></span>
<span><span class="co">##  [1]   627 <span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">CCC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span>-<span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span>...<span style="color: #000000; background-color: #AFFFFF;">GGGG</span><span style="color: #000000; background-color: #FFD7AF;">TTT</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">GGGG</span><span style="color: #000000; background-color: #FFAFAF;">AAA</span><span style="color: #000000; background-color: #AFFFAF;">CC</span> supercont3.1 of S...</span></span>
<span><span class="co">##  [2]   627 <span style="color: #EEEEEE; background-color: #B2B2B2;">NNNN</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">CCC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span>-<span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span>...<span style="color: #000000; background-color: #AFFFFF;">GGGG</span><span style="color: #000000; background-color: #FFD7AF;">TTT</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">GGGG</span><span style="color: #000000; background-color: #FFAFAF;">AAA</span><span style="color: #000000; background-color: #AFFFAF;">CC</span> supercont3.1 of S...</span></span>
<span><span class="co">##  [3]   627 <span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">CCC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span>-<span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span>...<span style="color: #000000; background-color: #AFFFFF;">GGGG</span><span style="color: #000000; background-color: #FFD7AF;">TTT</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">GGGG</span><span style="color: #000000; background-color: #FFAFAF;">AAA</span><span style="color: #000000; background-color: #AFFFAF;">CC</span> supercont1.1 of S...</span></span>
<span><span class="co">##  [4]   627 <span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">CCC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span>-<span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span>...<span style="color: #000000; background-color: #AFFFFF;">GGGG</span><span style="color: #000000; background-color: #FFD7AF;">TTT</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">GGGG</span><span style="color: #000000; background-color: #FFAFAF;">AAA</span><span style="color: #000000; background-color: #AFFFAF;">CC</span> supercont1.1 of S...</span></span>
<span><span class="co">##  [5]   627 <span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">CCC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span>-<span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span>...<span style="color: #000000; background-color: #AFFFFF;">GGGG</span><span style="color: #000000; background-color: #FFD7AF;">TTT</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">GGGG</span><span style="color: #000000; background-color: #FFAFAF;">AAA</span><span style="color: #000000; background-color: #AFFFAF;">CC</span> supercont1.1 of S...</span></span>
<span><span class="co">##  ...   ... ...</span></span>
<span><span class="co">## [84]   627 <span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">CCC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span>-<span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span>...<span style="color: #000000; background-color: #AFFFFF;">GGGG</span><span style="color: #000000; background-color: #FFD7AF;">TTT</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">GGGG</span><span style="color: #000000; background-color: #FFAFAF;">AAA</span><span style="color: #000000; background-color: #AFFFAF;">CC</span> gi|297189896|ref|...</span></span>
<span><span class="co">## [85]   627 <span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">CCC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span>-<span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span>...<span style="color: #000000; background-color: #AFFFFF;">GGGG</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">GGGG</span><span style="color: #000000; background-color: #FFAFAF;">AAA</span><span style="color: #000000; background-color: #AFFFAF;">CC</span> gi|224581106|ref|...</span></span>
<span><span class="co">## [86]   627 <span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">CCC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span>-<span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span>...<span style="color: #000000; background-color: #AFFFFF;">GGGG</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">GGGG</span><span style="color: #000000; background-color: #FFAFAF;">AAA</span><span style="color: #000000; background-color: #AFFFAF;">CC</span> gi|224581106|ref|...</span></span>
<span><span class="co">## [87]   627 <span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">CCC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span>-<span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span>...<span style="color: #000000; background-color: #AFFFFF;">GGGG</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">GGGG</span><span style="color: #000000; background-color: #FFAFAF;">AAA</span><span style="color: #000000; background-color: #AFFFAF;">CC</span> gi|224581106|ref|...</span></span>
<span><span class="co">## [88]   627 <span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">CCC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span>-<span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span>...<span style="color: #000000; background-color: #AFFFFF;">GGGG</span><span style="color: #000000; background-color: #FFD7AF;">TTT</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">GGGG</span><span style="color: #000000; background-color: #FFAFAF;">AAA</span><span style="color: #000000; background-color: #AFFFAF;">CC</span> gi|224581108|ref|...</span></span></code></pre>
<p>Many of these sequences are redundant or from the same genome. We can
de-replicate the sequences to accelerate tree building:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">seqs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">seqs</span><span class="op">)</span> <span class="co"># remove duplicated sequences</span></span>
<span></span>
<span><span class="va">ns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"^.*Streptomyces( subsp\\. | sp\\. | | sp_)([^ ]+).*$"</span>, <span class="st">"\\2"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">seqs</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">seqs</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">ns</span> <span class="co"># name by species</span></span>
<span><span class="va">seqs</span> <span class="op">&lt;-</span> <span class="va">seqs</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/duplicated.html" class="external-link">duplicated</a></span><span class="op">(</span><span class="va">ns</span><span class="op">)</span><span class="op">]</span> <span class="co"># remove redundant sequences from the same species</span></span>
<span><span class="va">seqs</span></span></code></pre></div>
<pre><code><span><span class="co">## DNAStringSet object of length 19:</span></span>
<span><span class="co">##      width seq                                              names               </span></span>
<span><span class="co">##  [1]   627 <span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">CCC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span>-<span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span>...<span style="color: #000000; background-color: #AFFFFF;">GGGG</span><span style="color: #000000; background-color: #FFD7AF;">TTT</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">GGGG</span><span style="color: #000000; background-color: #FFAFAF;">AAA</span><span style="color: #000000; background-color: #AFFFAF;">CC</span> albus</span></span>
<span><span class="co">##  [2]   627 <span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">CCC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span>-<span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span>...<span style="color: #000000; background-color: #AFFFFF;">GGGG</span><span style="color: #000000; background-color: #FFD7AF;">TTT</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">GGGG</span><span style="color: #000000; background-color: #FFAFAF;">AAA</span><span style="color: #000000; background-color: #AFFFAF;">CC</span> clavuligerus</span></span>
<span><span class="co">##  [3]   627 <span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">CCC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span>-<span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span>...<span style="color: #000000; background-color: #AFFFFF;">GGGG</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">GGGG</span><span style="color: #000000; background-color: #FFAFAF;">AAA</span><span style="color: #000000; background-color: #AFFFAF;">CC</span> ghanaensis</span></span>
<span><span class="co">##  [4]   627 <span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">CCC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span>-<span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span>...<span style="color: #000000; background-color: #AFFFFF;">GGGG</span><span style="color: #000000; background-color: #FFD7AF;">TTT</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">GGGG</span><span style="color: #000000; background-color: #FFAFAF;">AAA</span><span style="color: #000000; background-color: #AFFFAF;">CC</span> griseoflavus</span></span>
<span><span class="co">##  [5]   627 <span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">CCC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span>-<span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span>...<span style="color: #000000; background-color: #AFFFFF;">GGGG</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">GGGG</span><span style="color: #000000; background-color: #FFAFAF;">AAA</span><span style="color: #000000; background-color: #AFFFAF;">CC</span> lividans</span></span>
<span><span class="co">##  ...   ... ...</span></span>
<span><span class="co">## [15]   627 <span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">CCC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span>-<span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span>...<span style="color: #000000; background-color: #AFFFFF;">GGGG</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">GGGG</span><span style="color: #000000; background-color: #FFAFAF;">AAA</span><span style="color: #000000; background-color: #AFFFAF;">CC</span> cattleya</span></span>
<span><span class="co">## [16]   627 <span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">CCC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span>-<span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span>...<span style="color: #000000; background-color: #AFFFFF;">GGGG</span><span style="color: #000000; background-color: #FFD7AF;">TTT</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">GGGG</span><span style="color: #000000; background-color: #FFAFAF;">AAA</span><span style="color: #000000; background-color: #AFFFAF;">CC</span> bingchenggensis</span></span>
<span><span class="co">## [17]   627 <span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">CCC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span>-<span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span>...<span style="color: #000000; background-color: #AFFFFF;">GGGG</span><span style="color: #000000; background-color: #FFD7AF;">TTT</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">GGGG</span><span style="color: #000000; background-color: #FFAFAF;">AAA</span><span style="color: #000000; background-color: #AFFFAF;">CC</span> avermitilis</span></span>
<span><span class="co">## [18]   627 <span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">CCC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span>-<span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span>...<span style="color: #000000; background-color: #AFFFFF;">GGGG</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">GGGG</span><span style="color: #000000; background-color: #FFAFAF;">AAA</span><span style="color: #000000; background-color: #AFFFAF;">CC</span> C</span></span>
<span><span class="co">## [19]   627 <span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #AFFFAF;">CCC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #FFAFAF;">A</span>-<span style="color: #000000; background-color: #AFFFAF;">C</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">C</span>...<span style="color: #000000; background-color: #AFFFFF;">GGGG</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFAF;">CC</span><span style="color: #000000; background-color: #AFFFFF;">G</span><span style="color: #000000; background-color: #FFAFAF;">AA</span><span style="color: #000000; background-color: #FFD7AF;">T</span><span style="color: #000000; background-color: #AFFFFF;">GGGG</span><span style="color: #000000; background-color: #FFAFAF;">AAA</span><span style="color: #000000; background-color: #AFFFAF;">CC</span> Tu6071</span></span></code></pre>
<p>Now, it’s time to try our luck at finding the most likely tree. Here,
we will set a stringent time limit (0.05 hours) to make this example
faster, although longer time limits (e.g., 24 hours) are advised because
setting very short time limits leaves the result up to luck.</p>
<p>Note that <code>TreeLine</code> automatically selects a substitution
model based on Akaike information criterion (by default). It is possible
to specify specific model(s) (e.g., <code>model="GTR+G4"</code>) to
limit the possible selections and test your luck with fewer models.</p>
<p>Also, since <code>TreeLine</code> is a stochastic optimizer, it is
critical to always set the random number seed for reproducibility. You
can pick any lucky number, and if you every wonder how much you pushed
your luck, you can try running again from a different random number seed
to see how much the result came down to luck of the draw.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span> <span class="co"># set the random number seed</span></span>
<span></span>
<span><span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/TreeLine.html">TreeLine</a></span><span class="op">(</span><span class="va">seqs</span>, reconstruct<span class="op">=</span><span class="cn">TRUE</span>, maxTime<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span> <span class="co"># default is method="ML"</span></span></code></pre></div>
<pre><code>## Optimizing model parameters:
JC69     -ln(L) = 5039, AICc = 10152, BIC = 10300
JC69+G4  -ln(L) = 4723, AICc = 9523, BIC = 9675
K80      -ln(L) = 4983, AICc = 10042, BIC = 10194
K80+G4   -ln(L) = 4413, AICc = 8905, BIC = 9061
F81      -ln(L) = 5020, AICc = 10121, BIC = 10281
F81+G4   -ln(L) = 4464, AICc = 9012, BIC = 9176
HKY85    -ln(L) = 4953, AICc = 9989, BIC = 10154
HKY85+G4 -ln(L) = 4371, AICc = 8829, BIC = 8997
T92      -ln(L) = 4965, AICc = 10010, BIC = 10166
T92+G4   -ln(L) = 4394, AICc = 8869, BIC = 9029
TN93     -ln(L) = 4942, AICc = 9969, BIC = 10138
TN93+G4  -ln(L) = 4371, AICc = 8831, BIC = 9004
SYM      -ln(L) = 4954, AICc = 9995, BIC = 10163
SYM+G4   -ln(L) = 4406, AICc = 8900, BIC = 9072
GTR      -ln(L) = 4929, AICc = 9951, BIC = 10132
GTR+G4   -ln(L) = 4368, AICc = 8832, BIC = 9017
## 
## The selected model was:  HKY85+G4
## 
## PHASE 1 OF 3: INITIAL TREES
## 
## 1/3. Optimizing initial tree #1 of 10 to 100:
## -ln(L) = 4369.3 (-0.048%), 1 Climb  
## 1/3. Optimizing initial tree #2 of 10 to 100:
## -ln(L) = 4403.7 (+0.781%), 2 Climbs  
## 1/3. Optimizing initial tree #3 of 11 to 100:
## -ln(L) = 4367.8 (-0.033%), 6 Climbs  
## 
## PHASE 2 OF 3: REGROW GENERATION 1 OF 10 TO 20
## 
## 2/3. Optimizing regrown tree #1 of 10 to 100:
## -ln(L) = 4367.8 (-0.001%), 1 Climb  
## 2/3. Optimizing regrown tree #2 of 10 to 100:
## -ln(L) = 4367.8 (~0.000%), 1 Climb  
## 2/3. Optimizing regrown tree #3 of 10 to 100:
## -ln(L) = 4367.8 (0.000%), 0 Climbs  
## 2/3. Optimizing regrown tree #4 of 10 to 100:
## -ln(L) = 4369.3 (+0.035%), 0 Climbs  
## 2/3. Optimizing regrown tree #5 of 10 to 100:
## -ln(L) = 4367.8 (~0.000%), 1 Climb  
## 2/3. Optimizing regrown tree #6 of 10 to 100:
## -ln(L) = 4369.3 (+0.035%), 0 Climbs  
## 2/3. Optimizing regrown tree #7 of 10 to 100:
## -ln(L) = 4369.3 (+0.035%), 0 Climbs  
## 2/3. Optimizing regrown tree #8 of 10 to 100:
## -ln(L) = 4369.3 (+0.035%), 0 Climbs  
## 2/3. Optimizing regrown tree #9 of 10 to 100:
## -ln(L) = 4369.3 (+0.035%), 0 Climbs  
## 2/3. Optimizing regrown tree #10 of 10 to 100:
## -ln(L) = 4369.3 (+0.035%), 1 Climb  
## 
## PHASE 2 OF 3: REGROW GENERATION 2 OF 10 TO 20
## 
## 2/3. Optimizing regrown tree #1 of 10 to 100:
## -ln(L) = 4369.3 (+0.033%), 0 Climbs  
## 2/3. Optimizing regrown tree #2 of 10 to 100:
## -ln(L) = 4367.8 (-0.001%), 1 Climb  
## 2/3. Optimizing regrown tree #3 of 10 to 100:
## -ln(L) = 4369.3 (+0.035%), 1 Climb  
## 2/3. Optimizing regrown tree #4 of 10 to 100:
## -ln(L) = 4367.8 (~0.000%), 1 Climb  
## 2/3. Optimizing regrown tree #5 of 10 to 100:
## -ln(L) = 4367.3 (-0.011%), 2 Climbs  
## 2/3. Optimizing regrown tree #6 of 15 to 100:
## -ln(L) = 4367.8 (+0.011%), 0 Climbs  
## 2/3. Optimizing regrown tree #7 of 15 to 100:
## -ln(L) = 4367.8 (+0.011%), 0 Climbs  
## 2/3. Optimizing regrown tree #8 of 15 to 100:
## -ln(L) = 4367.8 (+0.012%), 2 Climbs  
## 2/3. Optimizing regrown tree #9 of 15 to 100:
## -ln(L) = 4367.8 (+0.011%), 0 Climbs  
## 2/3. Optimizing regrown tree #10 of 15 to 100:
## -ln(L) = 4369.3 (+0.045%), 1 Climb  
## 2/3. Optimizing regrown tree #11 of 15 to 100:
## -ln(L) = 4367.8 (+0.011%), 0 Climbs  
## 2/3. Optimizing regrown tree #12 of 15 to 100:
## -ln(L) = 4367.8 (+0.011%), 1 Climb  
## 2/3. Optimizing regrown tree #13 of 15 to 100:
## -ln(L) = 4369.3 (+0.045%), 0 Climbs  
## 2/3. Optimizing regrown tree #14 of 15 to 100:
## -ln(L) = 4367.8 (+0.011%), 0 Climbs  
## 2/3. Optimizing regrown tree #15 of 15 to 100:
## -ln(L) = 4367.8 (+0.011%), 0 Climbs  
## 
## PHASE 2 OF 3: REGROW GENERATION 3 OF 11 TO 20
## 
## 2/3. Optimizing regrown tree #1 of 11 to 100:
## -ln(L) = 4367.8 (-0.001%), 1 Climb  
## 2/3. Optimizing regrown tree #2 of 12 to 100:
## -ln(L) = 4369.3 (+0.035%), 0 Climbs  
## 2/3. Optimizing regrown tree #3 of 13 to 100:
## -ln(L) = 4369.3 (+0.035%), 0 Climbs  
## 2/3. Optimizing regrown tree #4 of 14 to 100:
## -ln(L) = 4369.3 (+0.035%), 0 Climbs  
## 2/3. Optimizing regrown tree #5 of 15 to 100:
## -ln(L) = 4369.3 (+0.035%), 1 Climb  
## 2/3. Optimizing regrown tree #6 of 16 to 100:
## -ln(L) = 4367.8 (0.000%), 1 Climb  
## 2/3. Optimizing regrown tree #7 of 17 to 100:
## -ln(L) = 4369.3 (+0.035%), 0 Climbs  
## 2/3. Optimizing regrown tree #8 of 18 to 100:
## -ln(L) = 4367.8 (0.000%), 1 Climb  
## 2/3. Optimizing regrown tree #9 of 19 to 100:
## -ln(L) = 4367.8 (~0.000%), 0 Climbs  
## 2/3. Optimizing regrown tree #10 of 20 to 100:
## -ln(L) = 4367.8 (+0.001%), 2 Climbs  
## 2/3. Optimizing regrown tree #11 of 21 to 100:
## -ln(L) = 4369.3 (+0.035%), 0 Climbs  
## 2/3. Optimizing regrown tree #12 of 22 to 100:
## -ln(L) = 4367.8 (~0.000%), 0 Climbs  
## 2/3. Optimizing regrown tree #13 of 23 to 100:
## -ln(L) = 4367.8 (~0.000%), 0 Climbs  
## 2/3. Optimizing regrown tree #14 of 24 to 100:
## -ln(L) = 4367.3 (-0.011%), 0 Climbs  
## 2/3. Optimizing regrown tree #15 of 24 to 100:
## -ln(L) = 4367.8 (+0.011%), 0 Climbs  
## 2/3. Optimizing regrown tree #16 of 24 to 100:
## -ln(L) = 4367.8 (+0.011%), 0 Climbs  
## 2/3. Optimizing regrown tree #17 of 24 to 100:
## -ln(L) = 4369.3 (+0.045%), 0 Climbs  
## 2/3. Optimizing regrown tree #18 of 24 to 100:
## -ln(L) = 4369.3 (+0.045%), 1 Climb  
## 2/3. Optimizing regrown tree #19 of 24 to 100:
## -ln(L) = 4367.8 (+0.011%), 1 Climb  
## 2/3. Optimizing regrown tree #20 of 24 to 100:
## -ln(L) = 4367.8 (+0.011%), 0 Climbs  
## 2/3. Optimizing regrown tree #21 of 24 to 100:
## -ln(L) = 4369.3 (+0.045%), 0 Climbs  
## 2/3. Optimizing regrown tree #22 of 24 to 100:
## -ln(L) = 4369.3 (+0.045%), 0 Climbs  
## 2/3. Optimizing regrown tree #23 of 24 to 100:
## -ln(L) = 4369.3 (+0.045%), 0 Climbs  
## 2/3. Optimizing regrown tree #24 of 24 to 100:
## -ln(L) = 4367.8 (+0.012%), 2 Climbs  
## 
## PHASE 2 OF 3: REGROW GENERATION 4 OF 11 TO 20
## 
## 2/3. Optimizing regrown tree #1 of 11 to 100:
## -ln(L) = 4367.8 (-0.001%), 1 Climb  
## 2/3. Optimizing regrown tree #2 of 12 to 100:
## -ln(L) = 4367.8 (~0.000%), 1 Climb  
## 2/3. Optimizing regrown tree #3 of 13 to 100:
## -ln(L) = 4367.8 (+0.001%), 2 Climbs  
## 2/3. Optimizing regrown tree #4 of 14 to 100:
## -ln(L) = 4367.8 (~0.000%), 0 Climbs  
## 2/3. Optimizing regrown tree #5 of 15 to 100:
## -ln(L) = 4367.8 (~0.000%), 0 Climbs  
## 2/3. Optimizing regrown tree #6 of 16 to 100:
## -ln(L) = 4367.8 (0.000%), 0 Climbs  
## 2/3. Optimizing regrown tree #7 of 17 to 100:
## -ln(L) = 4367.8 (~0.000%), 0 Climbs  
## 2/3. Optimizing regrown tree #8 of 18 to 100:
## -ln(L) = 4367.8 (~0.000%), 0 Climbs  
## 2/3. Optimizing regrown tree #9 of 19 to 100:
## -ln(L) = 4367.8 (~0.000%), 0 Climbs  
## 2/3. Optimizing regrown tree #10 of 20 to 100:
## -ln(L) = 4367.8 (~0.000%), 0 Climbs  
## 2/3. Optimizing regrown tree #11 of 21 to 100:
## -ln(L) = 4367.8 (~0.000%), 0 Climbs  
## 2/3. Optimizing regrown tree #12 of 22 to 100:
## -ln(L) = 4367.8 (0.000%), 0 Climbs  
## 2/3. Optimizing regrown tree #13 of 23 to 100:
## -ln(L) = 4367.8 (~0.000%), 0 Climbs  
## 2/3. Optimizing regrown tree #14 of 24 to 100:
## -ln(L) = 4367.8 (~0.000%), 0 Climbs  
## 2/3. Optimizing regrown tree #15 of 25 to 100:
## -ln(L) = 4367.8 (~0.000%), 0 Climbs  
## 2/3. Optimizing regrown tree #16 of 26 to 100:
## -ln(L) = 4367.8 (~0.000%), 0 Climbs  
## 2/3. Optimizing regrown tree #17 of 27 to 100:
## -ln(L) = 4367.8 (~0.000%), 0 Climbs  
## 2/3. Optimizing regrown tree #18 of 28 to 100:
## -ln(L) = 4367.8 (~0.000%), 0 Climbs  
## 2/3. Optimizing regrown tree #19 of 29 to 100:
## -ln(L) = 4367.8 (~0.000%), 0 Climbs  
## 2/3. Optimizing regrown tree #20 of 30 to 100:
## -ln(L) = 4367.8 (~0.000%), 0 Climbs  
## 2/3. Optimizing regrown tree #21 of 31 to 100:
## -ln(L) = 4367.8 (~0.000%), 0 Climbs  
## 2/3. Optimizing regrown tree #22 of 32 to 100:
## -ln(L) = 4367.8 (~0.000%), 0 Climbs  
## 2/3. Optimizing regrown tree #23 of 33 to 100:
## -ln(L) = 4367.8 (~0.000%), 0 Climbs  
## 2/3. Optimizing regrown tree #24 of 34 to 100:
## -ln(L) = 4367.3 (-0.011%), 0 Climbs  
## 2/3. Optimizing regrown tree #25 of 34 to 100:
## -ln(L) = 4367.8 (+0.011%), 0 Climbs  
## 2/3. Optimizing regrown tree #26 of 34 to 100:
## -ln(L) = 4367.8 (+0.011%), 0 Climbs  
## 2/3. Optimizing regrown tree #27 of 34 to 100:
## -ln(L) = 4367.8 (+0.011%), 0 Climbs  
## 2/3. Optimizing regrown tree #28 of 34 to 100:
## -ln(L) = 4367.8 (+0.011%), 0 Climbs  
## 2/3. Optimizing regrown tree #29 of 34 to 100:
## -ln(L) = 4367.8 (+0.011%), 0 Climbs  
## 2/3. Optimizing regrown tree #30 of 34 to 100:
## -ln(L) = 4367.8 (+0.011%), 0 Climbs  
## 2/3. Optimizing regrown tree #31 of 34 to 100:
## -ln(L) = 4367.8 (+0.011%), 0 Climbs  
## 2/3. Optimizing regrown tree #32 of 34 to 100:
## -ln(L) = 4367.8 (+0.011%), 0 Climbs  
## 2/3. Optimizing regrown tree #33 of 34 to 100:
## -ln(L) = 4367.8 (+0.011%), 0 Climbs  
## 2/3. Optimizing regrown tree #34 of 34 to 100:
## -ln(L) = 4367.8 (+0.011%), 0 Climbs  
## 
## PHASE 2 OF 3: REGROW GENERATION 5 OF 11 TO 20
## 
## 2/3. Optimizing regrown tree #1 of 11 to 100:
## -ln(L) = 4369.3 (+0.033%), 0 Climbs  
## 
## PHASE 3 OF 3: SHAKEN TREES
## 
## Grafting 9 trees to the best tree:
## -ln(L) = 4367.3 (0.000%), 0 Grafts of 6  
## 
## 3/3. Optimizing shaken tree #1 of 3 to 1000:
## -ln(L) = 4368.6 (+0.029%), 4 Climbs  
## 3/3. Optimizing shaken tree #2 of 3 to 1000:
## -ln(L) = 4370.7 (+0.079%), 4 Climbs  
## 3/3. Optimizing shaken tree #3 of 3 to 1000:
## -ln(L) = 4367.9 (+0.015%), 4 Climbs  
## 
## Grafting 3 trees to the best tree:
## -ln(L) = 4367.3 (0.000%), 0 Grafts of 0  
## 
## Model parameters:
## Frequency(A) = 0.179
## Frequency(C) = 0.234
## Frequency(G) = 0.344
## Frequency(T) = 0.243
## Transition rates = 3.673
## Transversion rates = 1
## Alpha = 0.193
## 
## Time difference of 149.12 secs</code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span> <span class="co"># reset seed</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tree</span><span class="op">)</span></span></code></pre></div>
<p><img src="GrowingTrees_files/figure-html/expr3-1.png" width="700">
{#f1} Maximum likelihood tree showing the relationships between
<em>Streptomyces</em> species.</p>
</div>
<div class="section level2">
<h2 id="plotting-branch-support-values">Plotting Branch Support Values<a class="anchor" aria-label="anchor" href="#plotting-branch-support-values"></a>
</h2>
<p>Maybe it was just beginner’s luck, but we already have a reasonable
looking starting tree! <code>TreeLine</code> automatically returns a
variety of information about the tree that can be accessed with the
<code>attributes</code> and <code>attr</code> functions:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">tree</span><span class="op">)</span> <span class="co"># view all attributes</span></span></code></pre></div>
<pre><code><span><span class="co">## $members</span></span>
<span><span class="co">## [1] 19</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $height</span></span>
<span><span class="co">## [1] 2.411835</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $state</span></span>
<span><span class="co">## [1] "------CACCGCCCGTCA-CGTCACGAAAGTCGGTAACACCCGAAGCCGGTGGCCCAACCCGTAA-GGGAGGGAGCTGTCGAAGGTGGGACCAGCGATTGGGACGAAGTCGTAACAAGGTAGCCGTACCGGAAGGTGCGGCTGGATCACCTCCTTTCTAAGGAGCACGTCGGGCCGGGGGGGTGGG------------AGGACCCAGGACGTCGGCGAATGTTCGGGACCGGTTAGCTCATGGGTGGAACGTTGACTAGTTGGCACG---GGGGGGGGGGGGGTCAGGAGTACTGCTTCTTGGGGGCGTGGAAGGT---GGGGGGGGGGGGCGGGGGGGGGGGCTGGCACGTTGTTG-GGTGTCTGAGGGGACGGCCGG-----GGGCGGGGGGTCGGT-------CCGGCCCCGGTGGA-------------GGGGGGGGGGTGAGGGGTG------CGTTGTTTGAGAACTGCACAGTGGACGCGAGCATCT--GTGGCCAAGTTTTTAAGGGCGCACGGTGGATGCCTTGGCACCAGGAACCGATGAAGGACGTGGGAGGCCGCGATAGGCCCCGGGGAGGTGTCAACCGAGCTTTGATCCGGGGGTGTCCGAATGGGGAAACC"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $class</span></span>
<span><span class="co">## [1] "dendrogram"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $siteLnLs</span></span>
<span><span class="co">##   [1]  -1.977113  -1.587972  -1.977113  -2.326699  -2.019363  -2.326699</span></span>
<span><span class="co">##   [7]  -2.168049  -2.479464  -2.168049  -2.168049  -1.723300  -2.168049</span></span>
<span><span class="co">##  [13]  -2.168049  -2.168049  -1.723300  -2.124848  -2.168049  -2.479464</span></span>
<span><span class="co">##  [19]   0.000000  -2.168049  -1.723300  -2.124848  -2.168049  -2.479464</span></span>
<span><span class="co">##  [25]  -4.666359  -1.723300  -2.479464  -2.479464  -2.479464  -1.723300</span></span>
<span><span class="co">##  [31]  -2.124848  -2.168049  -1.723300  -1.723300  -2.124848  -2.479464</span></span>
<span><span class="co">##  [37]  -5.937161  -4.666359  -5.937161  -2.168049  -2.168049  -2.168049</span></span>
<span><span class="co">##  [43]  -1.723300  -2.479464  -2.479464  -1.723300  -2.168049  -2.168049</span></span>
<span><span class="co">##  [49]  -4.966449  -4.451503  -2.124848  -1.723300  -1.723300  -2.168049</span></span>
<span><span class="co">##  [55]  -2.168049  -2.168049  -2.479464  -2.479464  -2.168049  -2.168049</span></span>
<span><span class="co">##  [61]  -2.168049 -12.146498  -7.998052 -15.851731 -13.692810  -6.797030</span></span>
<span><span class="co">##  [67]  -1.723300  -1.723300  -1.723300  -2.479464  -1.723300  -1.723300</span></span>
<span><span class="co">##  [73]  -1.723300  -2.479464  -1.723300  -8.789295 -11.925221  -1.723300</span></span>
<span><span class="co">##  [79]  -2.124848  -2.168049  -1.723300  -2.479464  -2.479464  -1.723300</span></span>
<span><span class="co">##  [85]  -1.723300  -2.124848  -1.723300  -1.723300  -1.723300  -2.479464</span></span>
<span><span class="co">##  [91]  -2.168049 -13.778149 -12.804177  -1.723300  -2.168049  -1.723300</span></span>
<span><span class="co">##  [97]  -2.479464  -2.124848  -2.124848  -1.723300  -1.723300  -1.723300</span></span>
<span><span class="co">## [103]  -2.479464  -2.168049  -1.723300  -2.479464  -2.479464  -1.723300</span></span>
<span><span class="co">## [109]  -2.124848  -2.168049  -1.723300  -2.124848  -2.479464  -2.479464</span></span>
<span><span class="co">## [115]  -2.168049  -2.479464  -2.479464  -1.723300  -1.723300  -2.124848</span></span>
<span><span class="co">## [121]  -2.479464  -1.723300  -2.168049  -2.168049  -1.723300  -2.124848</span></span>
<span><span class="co">## [127]  -2.479464  -2.168049  -2.168049  -1.723300  -1.723300  -2.479464</span></span>
<span><span class="co">## [133]  -2.479464  -1.723300  -1.723300  -2.124848  -1.723300  -2.168049</span></span>
<span><span class="co">## [139]  -1.723300  -1.723300  -2.168049  -2.124848  -1.723300  -1.723300</span></span>
<span><span class="co">## [145]  -2.479464  -2.124848  -2.168049  -2.479464  -2.168049  -2.168049</span></span>
<span><span class="co">## [151]  -2.124848  -2.168049  -2.168049  -2.124848  -2.124848  -2.124848</span></span>
<span><span class="co">## [157]  -2.168049  -2.124848  -2.479464  -2.479464  -1.723300  -1.723300</span></span>
<span><span class="co">## [163]  -2.479464  -1.723300  -2.168049  -2.479464 -14.732917 -19.615030</span></span>
<span><span class="co">## [169]  -5.518313 -12.100597 -12.353051 -13.635931 -17.266480 -13.345413</span></span>
<span><span class="co">## [175] -11.490028 -17.630518  -7.703991  -9.253026  -8.315014 -15.815134</span></span>
<span><span class="co">## [181] -22.520178 -19.600292  -8.211880 -12.247678 -11.206825 -10.941765</span></span>
<span><span class="co">## [187]  -8.696218 -12.805962  -9.780842 -11.362024 -14.352340 -11.159366</span></span>
<span><span class="co">## [193]  -7.031107  -7.287198  -6.028996 -10.171280  -9.308607  -8.605126</span></span>
<span><span class="co">## [199] -14.012723 -11.035972 -13.786568 -11.868379  -7.912659  -2.150732</span></span>
<span><span class="co">## [205]  -8.169436  -6.624085 -17.654315 -15.496431 -16.595056  -8.700226</span></span>
<span><span class="co">## [211] -15.629645 -10.103375 -14.406553 -14.368867  -6.740934  -2.168049</span></span>
<span><span class="co">## [217] -15.289691 -10.437372 -13.350917 -16.554796  -1.723300 -15.452191</span></span>
<span><span class="co">## [223] -17.499492 -15.823027 -16.641644 -14.862440 -18.674446 -12.159241</span></span>
<span><span class="co">## [229] -15.726458  -9.517112  -1.723300  -4.928890  -2.124848 -15.498133</span></span>
<span><span class="co">## [235]  -2.383962  -4.451503  -2.168049  -5.733283  -2.168049  -5.974720</span></span>
<span><span class="co">## [241] -11.586576  -1.723300  -4.966449  -4.451503  -4.649954  -1.723300</span></span>
<span><span class="co">## [247]  -4.966449  -4.750471  -4.750471  -4.666359  -1.723300  -2.124848</span></span>
<span><span class="co">## [253]  -2.124848  -1.723300  -5.974720 -17.321552  -5.080160  -4.750471</span></span>
<span><span class="co">## [259] -15.839943  -4.649954  -7.180210  -4.928890  -1.723300  -7.346673</span></span>
<span><span class="co">## [265] -11.028594 -15.345043 -19.046793 -19.277958 -13.257427 -21.892966</span></span>
<span><span class="co">## [271] -20.452506 -21.931954 -24.528516 -23.532232 -20.519953 -19.027676</span></span>
<span><span class="co">## [277] -22.506220 -25.264236 -23.212277 -26.976309 -21.408742 -24.188293</span></span>
<span><span class="co">## [283] -17.643961 -11.347287 -18.478331 -13.031446 -19.454679 -21.580305</span></span>
<span><span class="co">## [289]  -4.750471  -1.723300  -2.124848  -5.937161  -5.790126  -2.124848</span></span>
<span><span class="co">## [295]  -7.071851  -5.137003 -11.519011 -14.334006 -13.725841  -6.228586</span></span>
<span><span class="co">## [301]  -5.295591  -7.154994 -10.640117 -10.231013  -8.310779  -1.723300</span></span>
<span><span class="co">## [307] -13.745599  -7.313986  -9.675439  -1.723300 -10.747014  -9.212303</span></span>
<span><span class="co">## [313]  -8.982248 -25.444776 -17.504134 -15.814190  -1.453974  -1.416416</span></span>
<span><span class="co">## [319]  -1.416416  -7.406719 -21.301101 -23.703755 -21.871524 -22.437483</span></span>
<span><span class="co">## [325] -26.745995 -24.329741 -22.913663 -21.523092 -22.435055 -19.641231</span></span>
<span><span class="co">## [331] -12.714091  -3.775371 -19.057293 -23.767989 -23.646468 -18.484818</span></span>
<span><span class="co">## [337] -21.272376 -23.548214 -17.468276 -12.781908 -17.459656  -9.257525</span></span>
<span><span class="co">## [343] -16.895149  -5.137003  -8.501423  -1.723300  -1.723300  -5.790126</span></span>
<span><span class="co">## [349]  -8.391581  -2.168049  -7.635636 -12.512827  -4.649954  -1.723300</span></span>
<span><span class="co">## [355]  -5.733283  -5.080160  -1.723300  -1.453974  -1.723300  -1.723300</span></span>
<span><span class="co">## [361]  -5.733283 -13.636412 -11.763600  -2.168049  -2.124848  -1.723300</span></span>
<span><span class="co">## [367]  -4.750471 -10.697606  -1.723300  -1.723300 -23.759735 -12.354940</span></span>
<span><span class="co">## [373]  -7.512183  -1.723300 -11.152159 -17.215601  -4.549063 -16.971173</span></span>
<span><span class="co">## [379] -17.621380  -4.519910  -1.630734  -1.416416 -21.449224 -21.289464</span></span>
<span><span class="co">## [385] -23.463300  -8.540068 -20.373091 -12.582422 -22.948447 -14.851864</span></span>
<span><span class="co">## [391] -20.718664 -16.347484 -15.385052 -17.392105  -9.771097 -17.321675</span></span>
<span><span class="co">## [397] -24.322328 -16.330846  -1.893505  -1.453974  -1.416416  -1.416416</span></span>
<span><span class="co">## [403] -10.001481 -19.329461 -12.251406  -7.937739  -4.666359  -5.137003</span></span>
<span><span class="co">## [409]  -1.723300 -12.839594  -9.483141  -2.168049  -6.608074  -4.666359</span></span>
<span><span class="co">## [415] -17.972685  -8.232799  -7.537957 -17.291707 -32.966795  -2.479464</span></span>
<span><span class="co">## [421]   0.000000  -9.465364  -9.319381 -14.224099 -21.200973 -28.812282</span></span>
<span><span class="co">## [427] -21.134679 -20.021614 -21.698694 -17.378210 -18.040867 -17.756721</span></span>
<span><span class="co">## [433] -21.428010 -30.178889 -14.965928 -24.942753 -23.493116 -23.871653</span></span>
<span><span class="co">## [439] -22.576312 -13.605092 -19.663046 -16.591773  -1.723300  -7.412730</span></span>
<span><span class="co">## [445]  -8.502509 -15.820949 -18.977054  -4.928890  -1.723300  -1.723300</span></span>
<span><span class="co">## [451]  -7.412730  -1.723300  -5.617459 -15.706286  -6.665338  -1.587972</span></span>
<span><span class="co">## [457]  -1.587972  -1.977113  -4.666359  -1.723300  -5.080160  -2.124848</span></span>
<span><span class="co">## [463]  -1.723300 -13.075485  -2.124848  -2.124848  -1.723300  -2.479464</span></span>
<span><span class="co">## [469]  -1.723300  -2.479464  -2.479464  -2.168049  -9.690941 -10.729635</span></span>
<span><span class="co">## [475]  -4.666359  -2.479464 -12.010138  -2.479464  -1.723300  -2.124848</span></span>
<span><span class="co">## [481]  -1.723300  -1.723300  -2.479464  -4.666359  -1.723300  -2.168049</span></span>
<span><span class="co">## [487]  -8.750700  -2.479464  -1.723300  -2.168049  -2.479464  -2.124848</span></span>
<span><span class="co">## [493]  -2.168049  -2.124848  -1.416416  -1.416416  -1.723300  -2.124848</span></span>
<span><span class="co">## [499]  -1.723300  -1.723300  -4.666359  -2.168049  -2.479464  -2.479464</span></span>
<span><span class="co">## [505]  -1.723300  -2.124848  -2.124848  -5.080160  -2.124848  -2.124848</span></span>
<span><span class="co">## [511]  -2.479464  -2.479464  -1.723300  -1.723300  -1.723300  -2.168049</span></span>
<span><span class="co">## [517]  -4.451503  -2.168049  -2.479464  -4.666359  -1.723300  -1.723300</span></span>
<span><span class="co">## [523]  -2.124848  -1.723300  -1.723300  -2.479464  -2.124848  -1.723300</span></span>
<span><span class="co">## [529]  -4.666359  -2.168049  -2.124848  -2.124848  -1.723300  -1.723300</span></span>
<span><span class="co">## [535] -11.234000  -5.937161  -4.666359  -2.168049  -2.479464  -1.723300</span></span>
<span><span class="co">## [541]  -1.723300  -2.479464  -4.750471  -2.168049  -2.168049  -1.723300</span></span>
<span><span class="co">## [547]  -2.479464  -2.124848  -1.723300  -2.479464  -2.479464  -1.723300</span></span>
<span><span class="co">## [553]  -1.723300  -2.479464  -2.168049  -1.723300  -2.124848  -1.723300</span></span>
<span><span class="co">## [559]  -6.740934  -1.723300  -2.479464  -1.723300  -1.723300  -2.168049</span></span>
<span><span class="co">## [565]  -4.666359 -10.160604  -2.168049  -1.723300  -2.479464  -2.124848</span></span>
<span><span class="co">## [571]  -2.479464  -4.928890 -18.004244  -2.168049  -2.168049  -4.666359</span></span>
<span><span class="co">## [577]  -2.168049  -1.723300  -1.723300  -1.723300  -1.723300  -2.479464</span></span>
<span><span class="co">## [583]  -1.723300 -18.162933 -10.696155  -1.723300  -7.189917  -2.168049</span></span>
<span><span class="co">## [589]  -2.479464  -2.479464  -2.168049  -7.232653 -10.160604 -11.156210</span></span>
<span><span class="co">## [595]  -1.723300  -2.168049  -2.124848 -12.003954  -2.124848  -1.723300</span></span>
<span><span class="co">## [601]  -2.479464  -2.124848  -2.168049  -2.168049  -1.723300  -4.451503</span></span>
<span><span class="co">## [607]  -1.723300  -1.723300  -4.451503  -2.124848 -18.378773  -2.124848</span></span>
<span><span class="co">## [613]  -2.168049  -2.168049  -1.723300  -2.479464  -2.479464  -2.124848</span></span>
<span><span class="co">## [619]  -1.723300  -1.723300  -1.723300  -1.723300  -2.479464  -2.479464</span></span>
<span><span class="co">## [625]  -2.479464  -2.168049  -2.168049</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $method</span></span>
<span><span class="co">## [1] "ML"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $model</span></span>
<span><span class="co">## [1] "HKY85+G4"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $parameters</span></span>
<span><span class="co">##     FreqA     FreqC     FreqG     FreqT     FreqI       A/G       C/T       A/C </span></span>
<span><span class="co">## 0.1791570 0.2334275 0.3449375        NA        NA 3.6791536        NA        NA </span></span>
<span><span class="co">##       A/T       C/G    Indels     alpha </span></span>
<span><span class="co">##        NA        NA        NA 0.1933609 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $score</span></span>
<span><span class="co">## [1] 4367.286</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $midpoint</span></span>
<span><span class="co">## [1] 9.969238</span></span></code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">tree</span>, <span class="st">"score"</span><span class="op">)</span> <span class="co"># best score</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 4367.286</span></span></code></pre>
<p>The tree is (virtually) rooted at its midpoint by default. For
maximum likelihood trees, all internal nodes include aBayes branch
support values <span class="citation">[@Anisimova:2011]</span>. These
are given as probabilities that can be used in plotting on top of each
edge. We can also italicize the species names.</p>
<p>We lucked out because maximum likelihood and maximum parsimony trees
both provide branch supports in the form of the fraction of optimized
trees that contained a given partition (branch). These are accessible
from the “support” attribute. As luck would have it, support values and
(aBayes) probabilities are correlated, but support tends to be more
conservative.</p>
</div>
<div class="section level2">
<h2 id="ancestral-state-reconstruction">Ancestral State Reconstruction<a class="anchor" aria-label="anchor" href="#ancestral-state-reconstruction"></a>
</h2>
<p>We’re in luck one of the advantages of maximum likelihood and maximum
parsimony tree building methods is that they automatically predict
states at each internal node on the tree <span class="citation">[@Joy:2016]</span>. This feature is enabled when
<code>reconstruct</code> is set to <code>TRUE</code>. These character
states can be used by the function <code>MapCharacters</code> to
determine state transitions along each edge of the tree.</p>
</div>
<div class="section level2">
<h2 id="exporting-the-tree">Exporting the Tree<a class="anchor" aria-label="anchor" href="#exporting-the-tree"></a>
</h2>
<p>We’ve had a run of good luck with this tree, so we’d better save it
before our luck runs out! The functions <code>ReadDendrogram</code> and
<code>WriteDendrogram</code> will import and export trees in Newick file
format. If we leave the <code>file</code> argument blank then it will
print the output to the console for our viewing:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/WriteDendrogram.html">WriteDendrogram</a></span><span class="op">(</span><span class="va">tree</span>, file<span class="op">=</span><span class="st">""</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## ((("Mg1":0.02576825,"C":0.03192499):0.1660582,("Tu6071":0.006348737,("SPB78":0.01135088,("SPB74":0.06688365,(("griseus":0.02878721,"SirexAA-E":0.1148471):0.08502283,(((("coelicolor":2.618e-07,"lividans":0.04163606):0.06461245,"griseoflavus":0.05622295):0.02426656,("clavuligerus":0.1014992,("pristinaespiralis":0.1116758,("bingchenggensis":0.09915409,"cattleya":0.4795029):0.04033009):0.004399801):0.07055895):0.05806301,(("scabiei":0.1903115,"ghanaensis":0.2260006):0.1223492,("avermitilis":0.03043229,"albus":0.06766567):0.004792927):0.04471756):0.0936877):0.09408172):0.08130094):0.005214737):0.1804796):1.304215,"AA4":2.411835);</span></span></code></pre>
<p>To keep up our lucky streak, we should probably include any model
parameters in the output along with the tree. Luckily, Newick format
supports square brackets (i.e., “[]”) for comments, which we can append
to the end of the file for good luck:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">tree</span>, <span class="st">"parameters"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"["</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span>, <span class="va">params</span>, sep<span class="op">=</span><span class="st">"="</span>, collapse<span class="op">=</span><span class="st">","</span><span class="op">)</span>, <span class="st">"]"</span>, sep<span class="op">=</span><span class="st">""</span>, append<span class="op">=</span><span class="cn">TRUE</span>, file<span class="op">=</span><span class="st">""</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [FreqA=0.179156981275164,FreqC=0.23342748652929,FreqG=0.344937474694546,FreqT=NA,FreqI=NA,A/G=3.67915362965464,C/T=NA,A/C=NA,A/T=NA,C/G=NA,Indels=NA,alpha=0.193360888024673]</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="session-information">Session Information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h2>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Erik Wright.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
