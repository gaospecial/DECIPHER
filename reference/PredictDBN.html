<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Predicts a consensus RNA secondary structure from a multiple sequence
alignment using mutual information."><title>Predict RNA Secondary Structure in Dot-Bracket Notation — PredictDBN • DECIPHER</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Predict RNA Secondary Structure in Dot-Bracket Notation — PredictDBN"><meta property="og:description" content="Predicts a consensus RNA secondary structure from a multiple sequence
alignment using mutual information."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">DECIPHER</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.29.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/ArtOfAlignmentInR.html">The Art of Multiple Sequence Alignment in R</a>
    <a class="dropdown-item" href="../articles/ClassifySequences.html">Classify Sequences</a>
    <a class="dropdown-item" href="../articles/ClusteringSequences.html">Upsize your clustering with Clusterize</a>
    <a class="dropdown-item" href="../articles/DECIPHERing.html">Getting Started DECIPHERing</a>
    <a class="dropdown-item" href="../articles/DesignMicroarray.html">Design Microarray Probes</a>
    <a class="dropdown-item" href="../articles/DesignPrimers.html">Design Group-Specific Primers</a>
    <a class="dropdown-item" href="../articles/DesignProbes.html">Design Group-Specific FISH Probes</a>
    <a class="dropdown-item" href="../articles/DesignSignatures.html">Design Primers That Yield Group-Specific Signatures</a>
    <a class="dropdown-item" href="../articles/FindChimeras.html">Finding Chimeric Sequences</a>
    <a class="dropdown-item" href="../articles/FindingGenes.html">The Magic of Gene Finding</a>
    <a class="dropdown-item" href="../articles/FindingNonCodingRNAs.html">The Double Life of RNA: Uncovering Non-Coding RNAs</a>
    <a class="dropdown-item" href="../articles/GrowingTrees.html">Growing phylogenetic trees with TreeLine</a>
    <a class="dropdown-item" href="../articles/RepeatRepeat.html">Repeat, Repeat!</a>
    <a class="dropdown-item" href="../articles/normal.html">normal</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Predict RNA Secondary Structure in Dot-Bracket Notation</h1>
      
      <div class="d-none name"><code>PredictDBN.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Predicts a consensus RNA secondary structure from a multiple sequence
alignment using mutual information.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">PredictDBN</span><span class="op">(</span></span>
<span>  <span class="va">myXStringSet</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"states"</span>,</span>
<span>  minOccupancy <span class="op">=</span> <span class="fl">0.4</span>,</span>
<span>  impact <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1.2</span>, <span class="fl">0.4</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>  avgProdCorr <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  slope <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  shift <span class="op">=</span> <span class="fl">1.3</span>,</span>
<span>  threshold <span class="op">=</span> <span class="fl">0.4</span>,</span>
<span>  pseudoknots <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  weight <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  useFreeEnergy <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  deltaGrules <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  processors <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>myXStringSet</dt>
<dd><p>A <code>DNAStringSet</code> or <code>RNAStringSet</code> object
containing aligned sequences.</p></dd>


<dt>type</dt>
<dd><p>Character string indicating the type of results desired.  This
should be (an unambiguous abbreviation of) one of <code>"states"</code>,
<code>"pairs"</code>, <code>"evidence"</code>, <code>"scores"</code>, <code>"structures"</code>, or
<code>"search"</code>.  (See value section below.)</p></dd>


<dt>minOccupancy</dt>
<dd><p>Numeric specifying the minimum occupancy (1 - fraction
of gaps) required to include a column of the alignment in the prediction.</p></dd>


<dt>impact</dt>
<dd><p>A vector with four elements giving the weights of A/U, G/C,
G/U, and other pairings, respectively.  The last element of <code>impact</code> is
the penalty for pairings that are inconsistent with two positions being
paired (e.g., A/- or A/C).</p></dd>


<dt>avgProdCorr</dt>
<dd><p>Numeric specifying the weight of the average product
correction (APC) term, as described in Buslje et al. (2009).</p></dd>


<dt>slope</dt>
<dd><p>Numeric giving the slope of the sigmoid used to convert mutual
information values to scores ranging from zero to one.</p></dd>


<dt>shift</dt>
<dd><p>Numeric giving the relative shift of the sigmoid used to
convert mutual information values to scores ranging from zero to one.</p></dd>


<dt>threshold</dt>
<dd><p>Numeric specifying the score threshold at which to consider
positions for pairing.  Only applicable if <code>type</code> is <code>"states"</code> or
<code>"pairs"</code>.</p></dd>


<dt>pseudoknots</dt>
<dd><p>Integer indicating the maximum order of pseudoknots that
are acceptable.  A value of <code>0</code> will prevent pseudoknots in the
structure, whereas <code>1</code> (the default) will search for first-order
psuedoknots.  Only used if <code>type</code> is <code>"states"</code> or <code>"pairs"</code>.</p></dd>


<dt>weight</dt>
<dd><p>Either a numeric vector of weights for each sequence, a single
number implying equal weights, or <code>NA</code> (the default) to automatically
calculate sequence weights based on <code>myXStringSet</code>.</p></dd>


<dt>useFreeEnergy</dt>
<dd><p>Logical determining whether RNA free energy predictions
should be incorporated along with mutual information into the secondary
structure prediction.</p></dd>


<dt>deltaGrules</dt>
<dd><p>Free energy rules for all possible base pairings in
quadruplets.  If NULL, defaults to pseudoenergies
(<code><a href="deltaGrulesRNA.html">deltaGrulesRNA</a></code>).  Only applicable if <code>useFreeEnergies</code>
is <code>TRUE</code>.</p></dd>


<dt>processors</dt>
<dd><p>The number of processors to use, or <code>NULL</code> to
automatically detect and use all available processors.</p></dd>


<dt>verbose</dt>
<dd><p>Logical indicating whether to display progress.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>If <code>type</code> is <code>"states"</code> (the default), then the output is
a character vector with the predicted secondary structure assignment for
each position in <code>myXStringSet</code>.  Standard dot-bracket notation (DBN)
is used, where <code>.'' signifies an unpaired position, </code>('' and <code>)'' a paired position, and successive </code>[]'', <code>{}'', and </code>&lt;&gt;'' indicate
increasing order pseudoknots.  Columns below <code>minOccupancy</code> are denoted
by the ``-'' character to indicate that they contained too many gaps to be
included in the consensus structure.</p>


<p>If <code>type</code> is <code>"pairs"</code>, then a matrix is returned with one row for
each base pairing and three columns giving the positions of the paired bases
and their <code>pseudoknot</code> order.</p>


<p>If <code>type</code> is <code>"evidence"</code>, then a matrix is returned with one row
for each base pairing and three columns giving the positions of the paired
bases and their respective scores (greater than or equal to
<code>threshold</code>).  This differs from <code>type</code></p>
<p></p>
<p><code>"pairs"</code> in that
<code>"evidence"</code> does not perform a traceback.  Therefore, it is possible
to have conflicting evidence where a single base has evidence for pairing
with multiple other bases.</p>


<p>If <code>type</code> is <code>"scores"</code>, then a matrix of three rows is returned,
where the values in a column represent the maximum score for a state in each
position.  Columns sum to <code>1</code> if the position was above
<code>minOccupancy</code> and <code>0</code> otherwise.</p>


<p>If <code>type</code> is <code>"structures"</code>, then the output is a list with one
element for each sequence in <code>myXStringSet</code>.  Each list element
contains a matrix of dimension 3 (each state) by the number of nucleotides
in the sequence.  Columns of the matrix sum to zero where the nucleotide was
located in a position that was below <code>minOccupancy</code>.  Otherwise,
positions are considered paired if they are consistent with pairing (i.e.,
A/U, C/G, or G/U) in the consensus secondary structure.</p>


<p>If <code>type</code> is <code>"search"</code> then an attempt is made to find additional
secondary structure beyond positions exhibiting covariation.  First, anchors
are identified as pairs of covarying positions with their score above
<code>threshold</code>.  Next, the regions between anchors are searched for
previously unidentified stem loops.  Finally, any helices are assigned a
score according to their length, i.e. one minus the probability of finding
that many consecutive pairs within the anchor boundaries by chance.  Hence,
output <code>type</code></p>
<p></p>
<p><code>"search"</code> will find secondary structure outside of
the consensus structure shared by most sequences, and can identify secondary
structure in conserved alignment regions.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>PredictDBN</code> employs an extension of the method described by Freyhult
et al. (2005) for determining a consensus RNA secondary structure.  It uses
the mutual information (\(H\)) measure to find covarying positions in a
multiple sequence alignment.  The original method is modified by the
addition of different weights for each type of base pairing and each input
sequence.  The formula for mutual information between positions \(i\) and
\(j\) then becomes:</p>
<p>$$H(i,j) = \sum_{XY \in bp}^{} \left( impact(XY) \cdot f_{i,j}(XY) \cdot
\log_2 \left( \frac{f_{i,j}(XY)}{f_{i}(X) \cdot f_{j}(Y)} \right) \right)$$</p>
<p>where, \(bp\) denotes the base pairings A/U, C/G, and G/U; <code>impact</code>
is their weight; \(f\) is the frequency of single bases or pairs weighted
by the corresponding <code>weight</code> of each sequence.</p>
<p>A penalty is then added for bases that are inconsistent with pairing:</p>
<p>$$H_{mod}(i,j) = H(i,j) + \sum_{XY \notin bp}^{} \Big( impact(XY) \cdot
f_{i,j}(XY) \Big)$$</p>
<p>Next an average product correction (Buslje et al., 2009) is applied to the
matrix \(H\):</p>
<p>$$H_{APC}(i,j) = H_{mod}(i,j) - avgProdCorr \cdot
\frac{\overline{H_{mod}(i,.)} \cdot
\overline{H_{mod}(.,j)}}{\overline{H_{mod}(.,.)}}$$</p>
<p>The mutual information values are then rescaled between <code>0</code> and
<code>1</code> by applying a sigmoidal transformation, which is controlled by
<code>shift</code> and <code>slope</code>:</p>
<p>$$H_{final}(i,j) = \left( 1 + \exp \left( slope \cdot log_e \left(
\frac{H_{APC}(i,j)}{shift \cdot H_{APC}[n]} \right) \right) \right)^{-1}$$</p>
<p>where, \(n\) is the number of positions having <code>minOccupancy</code> divided
by two (i.e., the maximum possible number of paired positions) and
\(H_{APC}[n]\) denotes the \(n^{th}\) highest value in the matrix
\(H_{APC}\).</p>
<p>If <code>useFreeEnergies</code> is <code>TRUE</code>, mutual information is supplemented
with a probabalistic model of folding based on <code>deltaGrules</code>.  That is,
palindromes in each sequence are ranked by their free energy, and converted
to probabilities of base pairing by assuming an exponential distribution of
free energies.  This tends to improve predictive accuracy when the aligned
sequences are insufficiently diverse for considerable evidence of
compensatory mutations.</p>
<p>If <code>type</code> is <code>"states"</code> or <code>"pairs"</code>, the secondary structure
is determined using a variant of the Nussinov algorithm similar to that
described by Venkatachalam et al. (2014).  Pairings with a score below
<code>threshold</code> are not considered during the traceback.  If
<code>psuedoknots</code> is greater than <code>0</code>, paired positions are removed
from consideration and the method is applied again to find pseudoknots.</p>
<p>In practice the secondary structure prediction is most accurate when the
input alignment is of high quality, contains a wide diversity of sequences,
the number of sequences is large, no regions are completely conserved across
all sequences, and most of the sequences span the entire alignment (i.e.,
there are few partial/incomplete sequences).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Buslje, C., et al. (2009). Correction for phylogeny, small
number of observations and data redundancy improves the identification of
coevolving amino acid pairs using mutual information. Bioinformatics,
<b>25(9)</b>, 1125-1131.</p>
<p>Freyhult, E., et al. (2005). Predicting RNA Structure Using Mutual
Information. Applied Bioinformatics, <b>4(1)</b>, 53-59.</p>
<p>Venkatachalam, B., et al. (2014). Faster algorithms for RNA-folding using
the Four-Russians method. Algorithms for Molecular Biology : AMB,
<b>9(1)</b>, 1-12.</p>
<p>Wright, E. S. (2020). RNAconTest: comparing tools for noncoding RNA multiple
sequence alignment based on structural consistency. RNA 2020, 26, 531-540.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="PredictHEC.html">PredictHEC</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Erik Wright <a href="mailto:eswright@pitt.edu">eswright@pitt.edu</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># load the example non-coding RNA sequences</span></span></span>
<span class="r-in"><span><span class="va">db</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"Bacteria_175seqs.sqlite"</span>, package<span class="op">=</span><span class="st">"DECIPHER"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rna</span> <span class="op">&lt;-</span> <span class="fu"><a href="SearchDB.html">SearchDB</a></span><span class="op">(</span><span class="va">db</span>, type<span class="op">=</span><span class="st">"RNAStringSet"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Search Expression:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> select row_names, sequence from _Seqs where row_names in (select row_names</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> from Seqs)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RNAStringSet of length: 175</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Time difference of 0.01 secs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># predict the secondary structure in dot-bracket notation (dbn)</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">PredictDBN</span><span class="op">(</span><span class="va">rna</span>, <span class="st">"states"</span><span class="op">)</span> <span class="co"># predict the secondary structure in dbn</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="co"># pairs are denoted by (), and (optionally) pseudoknots by [], {}, and &lt;&gt;</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># convert the dot-bracket notation into pairs of positions within the alignment</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">PredictDBN</span><span class="op">(</span><span class="va">rna</span>, <span class="st">"pairs"</span><span class="op">)</span> <span class="co"># paired positions in the alignment</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="co"># matrix giving the pairs and their pseudoknot order (when &gt; 0)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot an arc diagram with the base pairings</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="cn">NA</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  xaxs<span class="op">=</span><span class="st">"i"</span>, yaxs<span class="op">=</span><span class="st">"i"</span>,</span></span>
<span class="r-in"><span>  xlab<span class="op">=</span><span class="st">"Alignment position"</span>, ylab<span class="op">=</span><span class="st">""</span>,</span></span>
<span class="r-in"><span>  bty<span class="op">=</span><span class="st">"n"</span>, xaxt<span class="op">=</span><span class="st">"n"</span>, yaxt<span class="op">=</span><span class="st">"n"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ticks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/pretty.html" class="external-link">pretty</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu">width</span><span class="op">(</span><span class="va">rna</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">ticks</span><span class="op">/</span><span class="fu">width</span><span class="op">(</span><span class="va">rna</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">ticks</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">pi</span>, len<span class="op">=</span><span class="fl">100</span><span class="op">)</span>, <span class="cn">NA</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">r</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">p</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="va">p</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fu">width</span><span class="op">(</span><span class="va">rna</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">r</span>, each<span class="op">=</span><span class="fl">101</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">p</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">p</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">/</span><span class="fu">width</span><span class="op">(</span><span class="va">rna</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">x</span>, each<span class="op">=</span><span class="fl">101</span><span class="op">)</span> <span class="op">+</span> <span class="va">r</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="va">rs</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">r</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="va">rs</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">r</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, xpd<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># show all available evidence of base pairing</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">PredictDBN</span><span class="op">(</span><span class="va">rna</span>, <span class="st">"evidence"</span><span class="op">)</span> <span class="co"># all pairs with scores &gt;= threshold</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="co"># matrix giving the pairs and their scores</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># determine the score at every alignment position</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">PredictDBN</span><span class="op">(</span><span class="va">rna</span>, <span class="st">"scores"</span><span class="op">)</span> <span class="co"># score in the alignment</span></span></span>
<span class="r-in"><span><span class="va">p</span><span class="op">[</span><span class="st">"("</span>, <span class="fl">122</span><span class="op">]</span> <span class="co"># score for left-pairing at alignment position 122</span></span></span>
<span class="r-in"><span><span class="va">p</span><span class="op">[</span><span class="st">")"</span>, <span class="fl">260</span><span class="op">]</span> <span class="co"># score for right-pairing at alignment position 260</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># find the scores individually for every sequence in the alignment</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">PredictDBN</span><span class="op">(</span><span class="va">rna</span>, <span class="st">"structures"</span><span class="op">)</span> <span class="co"># scores per sequence</span></span></span>
<span class="r-in"><span><span class="va">p</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="co"># the scores for the first position in the first sequence</span></span></span>
<span class="r-in"><span><span class="va">p</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>, <span class="fl">10</span><span class="op">]</span> <span class="co"># the scores for the tenth position in the second sequence</span></span></span>
<span class="r-in"><span><span class="co"># these positional scores can be used as shades of red, green, and blue:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="BrowseSeqs.html">BrowseSeqs</a></span><span class="op">(</span><span class="va">rna</span>, patterns<span class="op">=</span><span class="va">p</span><span class="op">)</span> <span class="co"># red = unpaired, green = left-pairing, blue = right</span></span></span>
<span class="r-in"><span><span class="co"># positions in black are not part of the consensus secondary structure</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># search for additional secondary structure between the consensus pairs</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">PredictDBN</span><span class="op">(</span><span class="va">rna</span>, <span class="st">"search"</span><span class="op">)</span> <span class="co"># scores per sequence after searching</span></span></span>
<span class="r-in"><span><span class="fu"><a href="BrowseSeqs.html">BrowseSeqs</a></span><span class="op">(</span><span class="va">rna</span>, patterns<span class="op">=</span><span class="va">p</span><span class="op">)</span> <span class="co"># red = unpaired, green = left-pairing, blue = right</span></span></span>
<span class="r-in"><span><span class="co"># note that "search" identified many more pairings than "structures"</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Erik Wright.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

