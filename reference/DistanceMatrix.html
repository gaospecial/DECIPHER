<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate the Distances Between Sequences — DistanceMatrix • DECIPHER</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate the Distances Between Sequences — DistanceMatrix"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">DECIPHER</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.29.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/ArtOfAlignmentInR.html">The Art of Multiple Sequence Alignment in R</a>
    <a class="dropdown-item" href="../articles/ClassifySequences.html">Classify Sequences</a>
    <a class="dropdown-item" href="../articles/ClusteringSequences.html">Upsize your clustering with Clusterize</a>
    <a class="dropdown-item" href="../articles/DECIPHERing.html">Getting Started DECIPHERing</a>
    <a class="dropdown-item" href="../articles/DesignMicroarray.html">Design Microarray Probes</a>
    <a class="dropdown-item" href="../articles/DesignPrimers.html">Design Group-Specific Primers</a>
    <a class="dropdown-item" href="../articles/DesignProbes.html">Design Group-Specific FISH Probes</a>
    <a class="dropdown-item" href="../articles/DesignSignatures.html">Design Primers That Yield Group-Specific Signatures</a>
    <a class="dropdown-item" href="../articles/FindChimeras.html">Finding Chimeric Sequences</a>
    <a class="dropdown-item" href="../articles/FindingGenes.html">The Magic of Gene Finding</a>
    <a class="dropdown-item" href="../articles/FindingNonCodingRNAs.html">The Double Life of RNA: Uncovering Non-Coding RNAs</a>
    <a class="dropdown-item" href="../articles/GrowingTrees.html">Growing phylogenetic trees with TreeLine</a>
    <a class="dropdown-item" href="../articles/RepeatRepeat.html">Repeat, Repeat!</a>
    <a class="dropdown-item" href="../articles/normal.html">normal</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Calculate the Distances Between Sequences</h1>
      
      <div class="d-none name"><code>DistanceMatrix.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">DistanceMatrix</span><span class="op">(</span></span>
<span>  <span class="va">myXStringSet</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"overlap"</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"matrix"</span>,</span>
<span>  includeTerminalGaps <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  penalizeGapLetterMatches <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  minCoverage <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  correction <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>  processors <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>myXStringSet</dt>
<dd><p>A <code>DNAStringSet</code>, <code>RNAStringSet</code>, or
<code>AAStringSet</code> object of aligned sequences.</p></dd>


<dt>method</dt>
<dd><p>Character string determining the region in which distance is
calculated.  This should be (an unambiguous abbreviation of) one of
<code>"overlap"</code>, <code>"shortest"</code>, or <code>"longest"</code>.  The default
<code>method</code> (<code>"overlap"</code>) calculates distance in the overlapping
region between terminal gaps when <code>includeTerminalGaps</code> is <code>FALSE</code>
and the entire alignment otherwise.  Setting <code>method</code> to
<code>"shortest"</code> or <code>"longest"</code> will use the region between the start
and end of the shortest or longest sequence, respectively, for each pairwise
distance.  The <code>method</code> is only relevant when
<code>includeTerminalGaps</code> is <code>TRUE</code>.</p></dd>


<dt>type</dt>
<dd><p>Character string indicating the type of output desired.  This
should be either <code>"matrix"</code> or <code>"dist"</code>.  (See value section
below.)</p></dd>


<dt>includeTerminalGaps</dt>
<dd><p>Logical specifying whether or not to include
terminal gaps ("-" or "." characters on each end of the sequence) into the
calculation of distance.</p></dd>


<dt>penalizeGapLetterMatches</dt>
<dd><p>Logical specifying whether or not to
consider gap-to-letter matches as mismatches.  If <code>FALSE</code>, then
gap-to-letter matches are not included in the total length used to calculate
distance.  The default (<code>TRUE</code>) is to penalize gap-to-letter mismatches
the same as letter-to-letter mismatches.  If <code>NA</code> then gap-to-letter
mismatches are only penalized once per insertion or deletion, i.e., when
changing to gap-to-letter or letter-to-gap.</p></dd>


<dt>minCoverage</dt>
<dd><p>Numeric between zero and one giving the minimum fraction
of sequence positions (not gap or mask) in the shortest sequence that must
be overlapping with the longer sequence in each pair.  Sequences below
<code>minCoverage</code> will be assigned <code>NA</code> distances.  Note that
non-overlapping sequences are always given <code>NA</code> distances, regardless
of <code>minCoverage</code>, unless <code>includeTerminalGaps</code> is <code>TRUE</code>
(distance = 100\<!-- %).} --></p>
<p>correctionThe substitution model used for distance correction.  This
should be (an abbreviation of) either <code>"none"</code>, <code>"Jukes-Cantor"</code>
(i.e., <code>"JC69"</code>), or <code>"F81"</code>.  For <code>"F81"</code> letter frequencies
are derived from <code>myXStringSet</code>.</p>
<p>processorsThe number of processors to use, or <code>NULL</code> to
automatically detect and use all available processors.</p>
<p>verboseLogical indicating whether to display progress.</p></dd>

</dl><p>If <code>type</code> is <code>"matrix"</code>, a symmetric matrix where each
element is the distance between the sequences referenced by the respective
row and column.  The <code>dimnames</code> of the matrix correspond to the
<code>names</code> of the <code>XStringSet</code>.If <code>type</code> is <code>"dist"</code>, an object of <code>class</code> <code>"dist"</code>
that contains one triangle of the distance matrix as a vector.  Since the
distance matrix is symmetric, storing only one triangle is more memory
efficient.</p>


<p>Calculates a distance matrix for an <code>XStringSet</code>.  Each element of the
distance matrix corresponds to the dissimilarity between two sequences in
the <code>XStringSet</code>.</p>


<p>The uncorrected (<code>correction = "none"</code>) distance matrix represents the
hamming distance between each of the sequences in <code>myXStringSet</code>.
Ambiguity can be represented using the characters of the
<code>IUPAC_CODE_MAP</code> for <code>DNAStringSet</code> and <code>RNAStringSet</code>
inputs, or using the <code>AMINO_ACID_CODE</code> for an <code>AAStringSet</code> input.
For example, the distance between an 'N' and any other nucleotide base is
zero.  The letters B (N or D), J (I or L), Z (Q or E), and X (any letter)
are degenerate in the <code>AMINO_ACID_CODE</code>.If <code>includeTerminalGaps = FALSE</code> then terminal gaps ("-" or "."
characters) are not included in sequence length.  This can be faster since
only the positions common to each pair of sequences are compared.  Sequences
with no overlapping region in the alignment are given a value of <code>NA</code>,
unless <code>includeTerminalGaps = TRUE</code>, in which case distance is 100\<!-- %. -->
Masked characters (<code>"+"</code>) in either sequence are not considered in
distance.Penalizing gap-to-letter mismatches specifies whether to penalize these
special mismatch types and include them in the total length when calculating
distance.  Both "-" and "." characters are interpreted as gaps.  The default
behavior is to calculate distance as the fraction of positions that differ
across the region of the alignment shared by both sequences (not including
gap-to-gap matches).Two correction factors are available, <code>"JC69"</code> and <code>"F81"</code>, which
are described in <code><a href="MODELS.html">MODELS</a></code>.  Both transform raw distance
(\(d\)) by $$-E * \log \left( 1 - d / E \right)$$, where $$E = 1 -
\sum_{i \in sym} f_i^2$$ and (\(f\)) is the relative frequency of each
symbol (\(sym\)).  In the <code>"JC69"</code> model symbols are assumed to have
equal frequency, whereas in the <code>"F81"</code> model the symbol frequencies
are empirically derived from the input <code>myXStringSet</code>.  Note that gaps
are treated as an additional symbol when <code>penalizeGapLetterMatches</code> is
<code>TRUE</code>.The elements of the distance matrix can be referenced by <code>dimnames</code>
corresponding to the <code>names</code> of the <code>XStringSet</code>.  Additionally,
an attribute named "correction" specifying the method of correction used can
be accessed using the function <code>attr</code>.</p>


<p># example of using the defaults:
dna &lt;- DNAStringSet(c("ACTG", "ACCG"))
dna
DistanceMatrix(dna)# changing the output type to "dist":
d &lt;- DistanceMatrix(dna, type="dist")
d
length(d) # minimal memory space required
m &lt;- as.matrix(d)
length(m) # more memory space required# supplying an AAStringSet
aa &lt;- AAStringSet(c("ASYK", "ATYK", "CTWN"))
aa
DistanceMatrix(aa)# defaults compare intersection of internal ranges:
dna &lt;- DNAStringSet(c("ANGCT-", "-ACCT-"))
dna
d &lt;- DistanceMatrix(dna)
d
# d[1,2] is 1 base in 4 = 0.25# compare union of internal positions, without terminal gaps:
dna &lt;- DNAStringSet(c("ANGCT-", "-ACCT-"))
dna
d &lt;- DistanceMatrix(dna, includeTerminalGaps=TRUE)
d
# d[1,2] is now 2 bases in 5 = 0.40# gap ("-") and unknown (".") characters are interchangeable:
dna &lt;- DNAStringSet(c("ANGCT.", ".ACCT-"))
dna
d &lt;- DistanceMatrix(dna, includeTerminalGaps=TRUE)
d
# d[1,2] is still 2 bases in 5 = 0.40# compare different methods for calculating distance:
dna &lt;- DNAStringSet(c("--ACTG", "TGAGT-"))
dna
DistanceMatrix(dna, method="overlap") # 1/3
DistanceMatrix(dna, method="overlap",
               minCoverage=1) # NA (only 3/4 overlapping)
DistanceMatrix(dna, method="shortest",
               includeTerminalGaps=FALSE) # 1/3
DistanceMatrix(dna, method="shortest",
               includeTerminalGaps=TRUE) # 2/4
DistanceMatrix(dna, method="shortest",
               includeTerminalGaps=TRUE,
               penalizeGapLetterMatches=FALSE) # 1/3
DistanceMatrix(dna, method="longest",
               includeTerminalGaps=FALSE) # 1/3
DistanceMatrix(dna, method="longest",
               includeTerminalGaps=TRUE) # 3/5
DistanceMatrix(dna, method="longest",
               includeTerminalGaps=TRUE,
               penalizeGapLetterMatches=FALSE) # 1/3# neither internal nor external gap/gap matches are considered:
dna &lt;- DNAStringSet(c("--A-CTA", "-AG-C--"))
dna
DistanceMatrix(dna) # 1/2
DistanceMatrix(dna, includeTerminalGaps=TRUE) # 4/5
DistanceMatrix(dna, includeTerminalGaps=TRUE,
               method="shortest") # 2/3
DistanceMatrix(dna, includeTerminalGaps=TRUE,
               method="longest") # 3/4</p>


<p><code><a href="TreeLine.html">TreeLine</a></code></p>


<p>Erik Wright <a href="mailto:eswright@pitt.edu">eswright@pitt.edu</a></p>


    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Erik Wright.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

